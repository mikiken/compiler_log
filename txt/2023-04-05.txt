==============================================================
Guild: ãƒ¡ãƒ¢å¸³
Channel: seccamp2022 / ä½œæ¥­ãƒ­ã‚°
==============================================================

[08/02/2022 11:59 AM] mikiken#5554
**é–¢æ•°å®šç¾©**


[08/02/2022 12:01 PM] mikiken#5554
```C
typedef struct Function Function;

struct Function {
  Function *next;
  Type *type;       // å‹
  char *name;       // é–¢æ•°å
  Lvar params_head; // å¼•æ•°ãƒªã‚¹ãƒˆã®å…ˆé ­
  Node *body;       // statement
  Lvar *locals;     // ãƒ­ãƒ¼ã‚«ãƒ«å¤‰æ•°ã®ãƒªã‚¹ãƒˆ
};
```


[08/02/2022 2:52 PM] mikiken#5554
1.æ•´æ•°ã‚’è¿”ã™ã ã‘ã®é–¢æ•°ãŒå®šç¾©ã§ãã‚‹ã‚ˆã†ã«


[08/06/2022 1:42 AM] mikiken#5554
offsetè¨ˆç®—ã™ã‚‹ã¨ã“ã‚ã§ã‚»ã‚°ãƒ•ã‚©ã—ã¦ã‚‹


[08/10/2022 9:22 AM] mikiken#5554
```C
struct Expr typecheck_expression(struct AnalyzerState *ptr_ps,
                                 const struct UntypedExpr *ref_uexpr)
```


[08/10/2022 10:00 AM] mikiken#5554
hsjoihsã€Œãªã®ã§ã€ãã‚Œã«ä¸€ã¤ãšã¤å‹æƒ…å ±ã‚’ä»˜ä¸ã—ã¦ã„ãå¿…è¦ãŒã‚ã‚Šã¾ã™ã€
hsjoihsã€Œã‚„ã‚Šæ–¹ã¯äºŒé€šã‚Šã‚ã£ã¦ã€ä¸€ã¤ã¯ã€ã„ã¾ã‚ã‚‹ Node ã‚’æ›¸ãæ›ãˆã¦ã€å‹æƒ…å ±ã‚’æ›¸ãè¾¼ã‚“ã§ã„ãæ–¹æ³•ã€
hsjoihsã€Œã‚‚ã†ä¸€ã¤ã¯ã€ä»Šã‚ã‚‹ AST ã‚’è¦‹ã¦ã€å†å¸°çš„ã«ã€ãã® AST ã®ã€å‹ãŒã¤ã„ãŸãƒãƒ¼ã‚¸ãƒ§ãƒ³ã€ã‚’ä½œã£ã¦ã„ãæ–¹æ³•ã€


[08/10/2022 10:43 AM] mikiken#5554


{Attachments}
https://cdn.discordapp.com/attachments/1003859454191751178/1006739418532544643/unknown.png


[08/10/2022 8:25 PM] mikiken#5554
å•é¡Œç‚¹
ãã‚‚ãã‚‚é–¢æ•°åã¨ã‹å‹ã®æƒ…å ±ã¨ã‹æ¸¡ã£ã¦ãªãã­?
å¼•æ•°ã¨ã—ã¦listã‚’å—ã‘å–ã£ã¦ã‚‹ã‘ã©çµå±€ä½¿ã£ã¦ãªãã­?


[08/11/2022 11:32 PM] mikiken#5554
**~~TODO~~(å¯¾å¿œæ¸ˆã¿)**
å¤‰æ•°ã®ã‚µã‚¤ã‚ºã«ã‚ˆã£ã¦ãƒ¬ã‚¸ã‚¹ã‚¿ã®åå‰ãŒå¤‰ã‚ã‚‹ã®ã§ã€ãã‚Œã«å¯¾å¿œã§ãã‚‹ã‚ˆã†ã«`codegen.c` ã‚’æ›¸ãæ›ãˆã‚‹


[08/12/2022 12:24 AM] mikiken#5554
http://yuma.ohgami.jp/Introduction-to-x86_64-Machine-Language/02_basic_operations.html


[08/22/2022 11:06 PM] mikiken#5554
**Step 21-2 é…åˆ—ã‹ã‚‰ãƒã‚¤ãƒ³ã‚¿ã¸ã®æš—é»™ã®å‹å¤‰æ›ã‚’å®Ÿè£…ã™ã‚‹**
ãƒ»å³è¾ºã«é…åˆ—å‹å¤‰æ•°ãŒç¾ã‚ŒãŸå ´åˆã€€`a` â†’ `&a` ã®ã‚ˆã†ã«ã‚­ãƒ£ã‚¹ãƒˆã™ã‚‹
ãƒ»æ˜ç¤ºçš„ã«`&a` ã¨æ›¸ã„ãŸã¨ãã¯ã€ä¸Šè¨˜ã®ã‚­ãƒ£ã‚¹ãƒˆã‚’è¡Œã‚ãªã„ã‚ˆã†ã«ã™ã‚‹
ãƒ»`*a = 1;` ã¿ãŸã„ãªå¼ãŒæ›¸ã‘ã‚‹ã‚ˆã†ã«(æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã§`a[i]` ã‚’`*(a+i)` ã«èª­ã¿æ›¿ãˆã‚‹ãŸã‚ã®æº–å‚™)
ãƒ»`sizeof(a)` ã¯`(1ã¤åˆ†ã®ã‚µã‚¤ã‚º) * (è¦ç´ æ•°)` ã‚’è¿”ã™


[08/23/2022 1:21 AM] mikiken#5554
æ–°ãŸã«å‡¦ç†ã‚’æ›¸ãè¶³ã™å¿…è¦ãŒã‚ã‚‹(ã¨æ€ã‚ã‚Œã‚‹)æ¼”ç®—å­
ãƒ»`+` `-` (æ¸ˆ)
ãƒ»`==` `!=` `<` `<=` `>` `>=` â†’ ãã‚‚ãã‚‚ãƒã‚¤ãƒ³ã‚¿ã«å¯¾ã—ã¦ã‚‚å¯¾å¿œã—ã¦ã„ãªã„ã®ã§å¾Œå›ã—
ãƒ»`=` (æ¸ˆ)
ãƒ»`*` (dereference) ã‚ªãƒšãƒ©ãƒ³ãƒ‰ã¨ã—ã¦ç›´æ¥é…åˆ—ãŒæ¥ãŸå ´åˆã«å¯¾å¿œã™ã‚‹å¿…è¦ã‚ã‚Š (æ¸ˆ)
ãƒ»`sizeof` (æ¸ˆ)
â€»`&` ã«ã¤ã„ã¦ æ˜ç¤ºçš„ã«`&` ã‚’æ›¸ã„ã¦ã„ã‚‹ã‹ã‚‰ã‚­ãƒ£ã‚¹ãƒˆã™ã‚‹å¿…è¦ãªã„ã¯ãš)


[08/23/2022 1:50 AM] mikiken#5554
ãƒã‚¤ãƒ³ã‚¿ã®åŠ ç®—ãƒ»æ¸›ç®—ã®ã†ã¡
ãƒ»`lhs` ãŒæ•°å­—/`rhs` ãŒãƒã‚¤ãƒ³ã‚¿ã®ã‚‚ã®ã¯å®Ÿè£…ã—ã¦ã„ãªã„ã¯ãš


[08/23/2022 6:51 PM] mikiken#5554
ä»£å…¥å¼ã®å·¦è¾º(`lhs` )ã«ç›´æ¥é…åˆ—ãŒæ¥ã‚‹ã“ã¨ã¯ã‚ã‚Šãˆãªã„


[08/23/2022 6:52 PM] mikiken#5554
```C
#include <stdio.h>
int main(char *argv[], int argc) {
  int a[2];
  a = 80;
  printf("%d", a[0]);
  return 0;
}
```
```
./Main.c: In function â€˜mainâ€™:
./Main.c:4:5: error: assignment to expression with array type
    4 |   a = 80;
      |     ^

```


[08/31/2022 3:58 PM] mikiken#5554
**TODO**
ãƒ»`int` ã‚’4byteã«
ãƒ»`(ä»»æ„ã®å‹)*` ã‚’8byteã«
ãƒ»é–¢æ•°å‘¼ã³å‡ºã—ã®éš›ã€rspã‚’16byteå¢ƒç•Œã«alignã™ã‚‹


[08/31/2022 5:31 PM] mikiken#5554
```C
void alloc4(int **p, int a, int b, int c, int d) {
  *p = malloc(sizeof(int) * 5);
  (*p)[0] = a;
  (*p)[1] = b;
  (*p)[2] = c;
  (*p)[3] = d;
  (*p)[4] = 100;
}
```
```
int alloc4(); int main(){int *p; alloc4(&p, 1, 2, 4, 8); return *(p+2);} => 100
```
ã“ã‚Œã¯gccãŒ`int` ã‚’4byteã¨ã—ã¦æ‰±ã£ã¦ã„ã‚‹ä¸€æ–¹ã€9ccã§ã¯8byteã¨ã—ã¦æ‰±ã£ã¦ã„ã‚‹ãŸã‚


[08/31/2022 5:40 PM] mikiken#5554
```
int main() {int a; a = 4; int b[2]; int *p; p = b; *p = 1; *(p+1) = 2; return a + *p + *(p+1);} => 7 expected, but got 5
```
ã¨ãªã‚‹ãŒã€
```
int main() {int a; a = 4; int b[2]; int *p; p = b; *p = 1; *(p-1) = 2; return a + *p + *(p-1);} => 7
```
ã¨ã™ã‚‹ã¨ä¸Šæ‰‹ãã„ã


[09/10/2022 8:33 AM] mikiken#5554
> PUSH copies the specified register, memory location, or immediate value to the top of stack. This instruction decrements the stack pointer by 2, 4, or 8, depending on the operand size, and then copies the operand into the memory location pointed to by SS:rSP.


[09/10/2022 8:34 AM] mikiken#5554
> POP copies a word, doubleword, or quadword from the memory location pointed to by the SS:rSP registers (the top of stack) to a specified register or memory location. Then, the rSP register is incremented by 2, 4, or 8. After the POP operation, rSP points to the new top of stack.


[09/25/2022 9:11 PM] mikiken#5554
> For addition, either both operands shall have arithmetic type, or one operand shall be a pointer to a complete object type and the other shall have integer type. (Incrementing is equivalent to adding 1.)


[09/25/2022 9:12 PM] mikiken#5554
> For subtraction, one of the following shall hold:
> ãƒ»both operands have arithmetic type;
> ãƒ»both operands are pointers to qualified or unqualified versions of compatible complete object types; or
> ãƒ»the left operand is a pointer to a complete object type and the right operand has integer type.
> (Decrementing is equivalent to subtracting 1.)
ã£ã¦ãªã£ã¦ã‚‹ã‘ã©ã€ã‚¹ã‚¿ãƒƒã‚¯æ“ä½œ(`pop`ã¨ã‹`push`)ã‚’è¡Œã†ã¨ãã¯8byteãƒ¬ã‚¸ã‚¹ã‚¿ã—ã‹å¼•æ•°ã«å–ã‚Œãªã„?(ã‚ã¾ã‚Šã‚ˆãåˆ†ã‹ã£ã¦ãªã„)


[09/25/2022 9:12 PM] mikiken#5554
http://port70.net/~nsz/c/c11/n1570.html#6.5.6


[09/28/2022 5:00 PM] mikiken#5554
ã‚‚ã—ã‹ã—ãŸã‚‰ãƒ­ãƒ¼ã‚«ãƒ«å¤‰æ•°ã®ãƒ¡ãƒ¢ãƒªä¸Šã§ã®é…ç½®ã®ä»•æ–¹ãŒgccã¨ã‹ã¨é•ã†ã‹ã‚‚(ãŠãã‚‰ãé€†é †)


[09/28/2022 5:00 PM] mikiken#5554
ãã‚‚ãã‚‚ã“ã†ã„ã†ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹
```C
int main() {int a; int b; a = 2; b = 8; int *p; int *q; p = &a; q = &b; return q - p;}
```
ã«å¯¾ã—ã¦1ãŒå¸°ã£ã¦ãã‚‹ä¿è¨¼ã¯ãªã„ã®ã§ã¯?
(`int a` ã¨ `int b` ãŒé€£ç¶šã—ã¦ç¢ºä¿ã•ã‚Œã‚‹ä¿è¨¼ã¯ãªã„ãŸã‚)


[09/28/2022 5:17 PM] mikiken#5554
> 2ã¤ã®ãƒã‚¤ãƒ³ã‚¿ã‚’æ¸›ç®—ã™ã‚‹å ´åˆã«ãŠã„ã¦ã€ãã®ä¸¡æ–¹ã®ãƒã‚¤ãƒ³ã‚¿ãŒåŒã˜é…åˆ—ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®è¦ç´ ã‹ã€ãã®é…åˆ—ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®æœ€å¾Œã®è¦ç´ ã‚’ä¸€ã¤è¶ŠãˆãŸã¨ã“ã‚ã‚’æŒ‡ã—ã¦ã„ãªã„å ´åˆã€‚(6.5.6)


[09/28/2022 5:17 PM] mikiken#5554
http://www.c-lang.org/detail/undefined_behavior.html


[10/07/2022 5:39 PM] mikiken#5554
**Step 25 æ–‡å­—åˆ—ãƒªãƒ†ãƒ©ãƒ«ã‚’å®Ÿè£…ã™ã‚‹**


[10/07/2022 5:40 PM] mikiken#5554
tokenizerã¯ã“ã†ã„ã†ã‚³ãƒ¼ãƒ‰ã‚’è¿½åŠ ã™ã‚Œã°ã„ã„ã¯ãš


[10/07/2022 5:41 PM] mikiken#5554
```C
Â Â Â Â //Â æ–‡å­—åˆ—ãƒªãƒ†ãƒ©ãƒ«ã®å ´åˆ 
 Â Â Â Â ifÂ (startswith(p,Â "\""))Â { 
 Â Â Â Â Â Â charÂ *startÂ =Â ++p;Â //Â ãƒ€ãƒ–ãƒ«ã‚¯ã‚ªãƒ¼ãƒˆã‚’èª­ã¿é£›ã°ã™ 
 Â Â Â Â Â Â whileÂ (*pÂ !=Â '\"') 
 Â Â Â Â Â Â Â Â p++; 
 Â Â Â Â Â Â curÂ =Â new_token(TK_STR,Â cur,Â start,Â pÂ -Â 1); 
 Â Â Â Â Â Â p++;Â //Â ãƒ€ãƒ–ãƒ«ã‚¯ã‚ªãƒ¼ãƒˆã‚’èª­ã¿é£›ã°ã™ 
 Â Â Â Â Â Â continue; 
 Â Â Â Â }
```


[10/07/2022 5:44 PM] mikiken#5554
`launch.json`ã®`args`ã«ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã‚’æ¸¡ã™ã¨ãã€ãƒ€ãƒ–ãƒ«ã‚¯ã‚ªãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã‚’`\\\"`ã¨ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã—ãªã„ã¨ã„ã‘ãªã„


[10/09/2022 11:07 PM] mikiken#5554
æ–‡å­—åˆ—ãƒªãƒ†ãƒ©ãƒ«ã‚’å¤‰æ›´ã—ã‚ˆã†ã¨ã™ã‚‹ã¨ã‚»ã‚°ãƒ•ã‚©ã™ã‚‹ã®ã‚’å®Ÿé¨“
```C
#include <stdio.h>
char *str = "Hello, implementation-defined behavior!";

int main(int argc, int **argv) {
  printf("%s\n", str);
  str[5] = '!'; // ã“ã“ã§ã‚»ã‚°ãƒ•ã‚©ã™ã‚‹(ã‘ã©ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ™‚ã«warningã•ãˆå‡ºãªã„)
  printf("%s\n", str);
  return 0;
}
```


[10/09/2022 11:09 PM] mikiken#5554
æ–‡å­—åˆ—ãƒªãƒ†ãƒ©ãƒ«ãŒ`char`ã®é…åˆ—ã¨ã—ã¦æ‰±ã‚ã‚Œã‚‹ã®ã¯ã€ä¾‹å¤–çš„ãªå ´åˆã®ã¿
```C
char str[] = "Good bye"; // åˆæœŸåŒ–å¼ã ã‹ã‚‰charã®é…åˆ—ã¨ã—ã¦æ›¸ã‘ã‚‹
str[5] = 'B';
```


[10/09/2022 11:10 PM] mikiken#5554
ãªã®ã§ã“ã®æ®µéšã§ã¯æ°—ã«ã™ã‚‹å¿…è¦ã¯ãªãã€æ–‡å­—åˆ—ãƒªãƒ†ãƒ©ãƒ«ã¯ã™ã¹ã¦ã‚°ãƒ­ãƒ¼ãƒãƒ«ã«ç¢ºä¿ã—ã¦ã€ãã®é ˜åŸŸã¸ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’è¿”ã™ã‚ˆã†ã«ã™ã‚Œã°OKãªã¯ãš


[10/10/2022 2:25 AM] mikiken#5554
æ—¢å­˜ã®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã®å‡ºåŠ›ã‚’è¦³å¯Ÿã—ã¦ã¿ã‚‹
```C
int main() { char *str = "abc"; return str[0]; }
```
ã«å¯¾ã™ã‚‹å‡ºåŠ›


[10/10/2022 2:26 AM] mikiken#5554
x86-64 clang 15.0.0
https://godbolt.org/z/dYWx1zchq

{Embed}
https://godbolt.org/z/dYWx1zchq
Compiler Explorer - C (x86-64 clang 15.0.0)
int main() { char *str = "abc"; return str[0]; }
https://images-ext-2.discordapp.net/external/jGTpmeGUxpLs6alHNMw1q89lgpPm0EpuohWGxIobk-o/%3Fraw%3Dtrue/https/github.com/compiler-explorer/infra/blob/main/logo/favicon.png


[10/10/2022 2:26 AM] mikiken#5554
x86-64 gcc 12.2
https://godbolt.org/z/Y4c8r1Exr

{Embed}
https://godbolt.org/z/Y4c8r1Exr
Compiler Explorer - C (x86-64 gcc 12.2)
int main() { char *str = "abc"; return str[0]; }
https://images-ext-2.discordapp.net/external/jGTpmeGUxpLs6alHNMw1q89lgpPm0EpuohWGxIobk-o/%3Fraw%3Dtrue/https/github.com/compiler-explorer/infra/blob/main/logo/favicon.png


[10/11/2022 6:58 AM] mikiken#5554
**ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã‚’å®Ÿè£…ã™ã‚‹**
> Escape sequences are defined using themselves here. E.g. '\n' is implemented using '\n'. This tautological definition works because the compiler that compiles our compiler knows what '\n' actually is. In other words, we "inherit" the ASCII code of '\n' from the compiler that compiles our compiler, so we don't have to teach the actual code here. This fact has huge implications not only for the correctness of the compiler but also for the security of the generated code. For more info, read "Reflections on Trusting Trust" by Ken Thompson.
> https://github.com/rui314/chibicc/wiki/thompson1984.pdf


[10/11/2022 6:59 AM] mikiken#5554
https://github.com/rui314/chibicc/blob/ad7749f2fad87a4b1df644d4e1c345b3f87d386d/tokenize.c

{Embed}
https://github.com/rui314/chibicc/blob/ad7749f2fad87a4b1df644d4e1c345b3f87d386d/tokenize.c
chibicc/tokenize.c at ad7749f2fad87a4b1df644d4e1c345b3f87d386d Â· ru...
A small C compiler. Contribute to rui314/chibicc development by creating an account on GitHub.
https://images-ext-1.discordapp.net/external/BZz5v82krgIoVW42SJfqqS9WahmlHR6NL9PR674rjWg/https/opengraph.githubassets.com/9aae4711251a70fc3107b9452c18ff129ca07fd4cef63635c316cf9bf2363339/rui314/chibicc


[10/12/2022 10:21 PM] mikiken#5554
ãƒ»æœ€å¾Œã®"ã‚’èªè­˜ã—ã¦ã€æ–‡å­—åˆ—ãƒªãƒ†ãƒ©ãƒ«ã®æ–‡å­—æ•°åˆ†ã®charã®é…åˆ—ã‚’ç¢ºä¿ã™ã‚‹
ãƒ»ä¸€æ–‡å­—ãšã¤èª­ã‚“ã§ã„ã£ã¦ã€ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã˜ã‚ƒãªã‹ã£ãŸã‚‰ãã®ã¾ã¾é…åˆ—ã®iæ–‡å­—ç›®ã«æ›¸ãè¾¼ã‚€
ãƒ»ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã®å ´åˆã¯ã†ã¾ãæ‰±ãˆã‚‹ã‚ˆã†ã«æ–‡å­—ã‚’ç½®ãæ›ãˆã¦é…åˆ—ã®iæ–‡å­—ç›®ã«æ ¼ç´ã™ã‚‹


[10/17/2022 6:05 PM] mikiken#5554
**Step27 è¡Œã‚³ãƒ¡ãƒ³ãƒˆã¨ãƒ–ãƒ­ãƒƒã‚¯ã‚³ãƒ¡ãƒ³ãƒˆã‚’å®Ÿè£…ã™ã‚‹**
ãŸã¶ã‚“`tokenize.c`ã«å°‘ã—å‡¦ç†è¶³ã›ã°ä¸€ç¬ã§ã§ãã‚‹ã®ã§ã€ã¨ã‚Šã‚ãˆãšå¾Œå›ã—ã«ã—ã¦ã€Step28ã«é€²ã‚€(ä»Šã®ã¾ã¾ã ã¨ãƒ†ã‚¹ãƒˆãŒæ›¸ãã«ãã„ã®ã§)


[10/17/2022 6:23 PM] mikiken#5554
**Step28 ãƒ†ã‚¹ãƒˆã‚’Cã§æ›¸ãç›´ã™**


[10/17/2022 11:30 PM] mikiken#5554
**`printf`ã‚’ä½¿ã†ã«ã‚ãŸã£ã¦**
ãƒ»ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆæŒ‡å®šå­(`%d`ãªã©)ã«ã¤ã„ã¦ã¯ã€ã¨ã‚Šã‚ãˆãšå¼•æ•°ã•ãˆã¡ã‚ƒã‚“ã¨æ¸¡ã›ã°å¤§ä¸ˆå¤«ãªã¯ãš
ãƒ»å¯å¤‰é•·å¼•æ•°ã‚’å–ã‚‹é–¢æ•°ã‚’å‘¼ã¶ã®ã§ã€`call`å‘½ä»¤ã®å‰ã§æµ®å‹•å°æ•°ç‚¹æ•°å¼•æ•°ã®å€‹æ•°ã‚’`al`ã«å…¥ã‚Œã¦ãŠãå¿…è¦ã‚ã‚Š


[10/18/2022 2:40 PM] mikiken#5554
ãƒ‡ãƒãƒƒã‚°ç”¨
https://godbolt.org/z/6fb9K6c1a

{Embed}
https://godbolt.org/z/6fb9K6c1a
Compiler Explorer - C (x86-64 gcc 12.1)
int printf();
int exit();

int assert(int expected, int actual, char *code) {
  if (expected == actual) {
    printf("%s => %d\n", code, actual);
  }
  else {
    printf("%s => %d expected, but got %d\n", code, expected, actual);
    exit(1);
  }
  return 0;
}

int main() {
    return 0;
}
https://images-ext-2.discordapp.net/external/jGTpmeGUxpLs6alHNMw1q89lgpPm0EpuohWGxIobk-o/%3Fraw%3Dtrue/https/github.com/compiler-explorer/infra/blob/main/logo/favicon.png


[10/21/2022 7:12 PM] mikiken#5554
**å®Ÿè£…ã™ã‚‹ã¨ãã«è€ƒãˆã¦ãŸã“ã¨ã®ãƒ¡ãƒ¢**
ä½•ã—ãŸã‚‰ã„ã„ã‹åˆ†ã‹ã‚Šã¥ã‚‰ã„ã®ã§ã€ã¨ã‚Šã‚ãˆãšã€`test.c`1ãƒ•ã‚¡ã‚¤ãƒ«ã«å…¨ã¦ã®å‡¦ç†ã‚’ãƒ™ã‚¿æ›¸ãã—ã¦ã¿ã‚‹


[10/21/2022 7:12 PM] mikiken#5554
ã¾ãšã¯æ•´æ•°1ã¤ã‚’è¿”ã™ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã‚’é€šã›ã‚‹ã‚ˆã†ã«ã™ã‚‹


[10/21/2022 7:12 PM] mikiken#5554
ã“ã‚ŒãŒé€šã£ãŸã®ã§ã€ã‚ã¨ã¯ã„ã„æ„Ÿã˜ã«æ‹¡å¼µã™ã‚Œã°ã„ã‘ãã†


[10/21/2022 7:13 PM] mikiken#5554
é–¢æ•°ã®å¼•æ•°ã«æ¸¡ã›ã‚‹ã®ã¯expressionã§ã‚ã£ã¦statementã¯æ¸¡ã›ãªã„ã®ã§ã€statementã‚’æ¸¡ã—ãŸã„ã¨ãã¯ã€åˆ¥é€”é–¢æ•°ã‚’ä½œã£ã¦ã€å¼•æ•°ã¨ã—ã¦ãã®é–¢æ•°(ã®è¿”ã‚Šå€¤)ã‚’æ¸¡ã›ã°è‰¯ã•ãã†


[10/21/2022 7:14 PM] mikiken#5554
å…¨ã¦ã®ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã‚’`test.c`ã«ç§»ã™ã¨800è¡Œã¨ã‹ã«ãªã£ãŸã®ã§ã€ã„ãã¤ã‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«åˆ†å‰²ã—ãŸæ–¹ãŒè‰¯ã•ãã†


[10/22/2022 2:37 AM] mikiken#5554
é©å½“ã«7ãƒ•ã‚¡ã‚¤ãƒ«ãã‚‰ã„ã«åˆ†å‰²ã—ãŸ


[10/22/2022 2:38 AM] mikiken#5554
`make clean`ãŒã€ã‚µãƒ–ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«å¯¾ã—ã¦ã‚‚ã„ã„æ„Ÿã˜ã«ä½œç”¨ã—ã¦ã»ã—ã„


[10/22/2022 2:38 AM] mikiken#5554
```makefile
# ccã«æ¸¡ã™ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æŒ‡å®š
CFLAGS=-std=c11 -g -static
# src/*.cã‚’ã‚½ãƒ¼ã‚¹ã¨ã—ã¦æŒ‡å®š
SRCS=$(wildcard src/*.c)
# SRCSã®æœ«å°¾ã‚’.oã«ç½®æ›ã—ãŸåå‰ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦æŒ‡å®š
OBJS=$(SRCS:.c=.o)
# ãƒ†ã‚¹ãƒˆã®ã‚½ãƒ¼ã‚¹ã‚’æŒ‡å®š
TEST_SRCS=$(wildcard test/test_src/*.c)

# 9ccã®ä¾å­˜é–¢ä¿‚ã‚’æŒ‡å®šã—ã€ãã‚Œã«å¯¾ã™ã‚‹ãƒ«ãƒ¼ãƒ«ã‚’è¨­å®š
9cc: $(OBJS)
                $(CC) -o 9cc $(OBJS) $(LDFLAGS)

# OBJSã®ä¾å­˜é–¢ä¿‚ã‚’æŒ‡å®š
$(OBJS): src/9cc.h

# testã®ä¾å­˜é–¢ä¿‚ã‚’æŒ‡å®šã—ã€ãã‚Œã«å¯¾ã™ã‚‹ãƒ«ãƒ¼ãƒ«ã‚’è¨­å®š
test: 9cc
                ./test/test_driver.sh

# cleanã«å¯¾ã™ã‚‹ãƒ«ãƒ¼ãƒ«ã‚’è¨­å®š
clean:
                rm -f 9cc src/*.o test/*.s tmp* .gdb_history peda-session-*.txt src/peda-session-*.txt .vscode/peda-session-*.txt

# testã¨cleanã‚’ãƒ€ãƒŸãƒ¼ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ(å®Ÿéš›ã«å­˜åœ¨ã—ãªã„ãƒ•ã‚¡ã‚¤ãƒ«)ã«æŒ‡å®š
.PHONY: test clean
```


[10/22/2022 2:39 AM] mikiken#5554
`SUBDIR`çš„ãªå¤‰æ•°ã‚’ç”¨æ„ã—ã¦ã€ã‚´ãƒ‹ãƒ£ã‚´ãƒ‹ãƒ£ã—ãŸã‚‰ã†ã¾ãã„ããã†(?)


[10/24/2022 5:59 PM] mikiken#5554
**%æ¼”ç®—å­ã‚’å®Ÿè£…ã™ã‚‹**


[10/24/2022 5:59 PM] mikiken#5554
http://port70.net/~nsz/c/c11/n1570.html#6.5.5


[10/24/2022 6:00 PM] mikiken#5554
> Each of the operands shall have arithmetic type. The operands of the % operator shall have integer type.


[10/24/2022 11:39 PM] mikiken#5554
ä¾‹ã®ãƒ‰ãƒ¼ãƒŠãƒ„ã®ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹
https://github.com/hsjoihs/c-compiler/blob/master/misc/donut_donut.c

{Embed}
https://github.com/hsjoihs/c-compiler/blob/master/misc/donut_donut.c
c-compiler/donut_donut.c at master Â· hsjoihs/c-compiler
seccamp2018 c compiler. Contribute to hsjoihs/c-compiler development by creating an account on GitHub.
https://images-ext-1.discordapp.net/external/vLLxuiw2QPIVJJL3UOAtcL5b-2yN48BTZnHG5BhWzYM/https/opengraph.githubassets.com/bb4c508b95c6221a9f1d8542652c6e03ea8ffa887d98ad3c322ba72dbe3d95aa/hsjoihs/c-compiler


[10/24/2022 11:41 PM] mikiken#5554
ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã—ãŸã‚„ã¤
```C
int putchar();
void *memset();

int m(int a, int b) {
  return (a * b + 5000) / 10000;
}

void a(int *c, int *s, int d, int t) {
  int k = m(*c, d) - m(*s, t);
  int l = m(*s, d) + m(*c, t);
  *c = k;
  *s = l;
}

int usleep();
int printf();

int main() {
  int z[1760];
  char b[1760];
  printf("\e[2J");
  int s = 10000;
  int q = s;
  int r = 0;
  int u = s;
  int v = 0;
  for (;; a(&q, &r, s - 8, 400), a(&u, &v, s - 2, 200)) {
    memset(b, 32, 1760);
    memset(z, 0, 7040);
    int l = 0;
    int p = s;
    for (int i = 0; i < 88; i++, a(&p, &l, 9974 + i % 2, 714)) {
      int w = 0;
      int e = s;
      for (int j = 0; j < 314; j++, a(&e, &w, s - 2, 200)) {
        int f = p + 2 * s;
        int g = s * s / (m(m(w, f), r) + m(l, q) + 5 * s);
        int t = m(m(w, q), f) - m(l, r);
        int x = 40 + 30 * m(g, m(m(e, u), f) - m(t, v)) / s;
        int y = 12 + 15 * m(g, m(m(e, v), f) + m(t, u)) / s;
        int o = x + 80 * y;
        int N = 8 * (m(m(l, r) - m(m(w, q), p), u) - m(m(w, r), p) - m(l, q) - m(m(e, v), p)) / s;
        if (y > 0 && g > z[o] && y < 22 && x > 0 && 80 > x) {
          z[o] = g;
          b[o] = ".,-~:;=!*#$@"[N >= 1 ? N : 0] + 0;
        }
      }
    }
    printf("\e[H");
    for (int k = 0; k < 1761; k++)
      putchar(k % 80 ? b[k] : 10);
    printf("Author: @a1k0n. Rewritten by @hsjoihs so that it works without floating types.\nNote that rounding errors gradually reduce the donut's size.\n");
    usleep(50000);
  }
  return 0;
}
```


[10/24/2022 11:42 PM] mikiken#5554
ã“ã‚Œè¦‹ã‚‹ã¨ã€
ãƒ»åˆæœŸåŒ–å¼å…¨èˆ¬
ãƒ»`void`å‹
~~ãƒ»`&&`æ¼”ç®—å­(ã¨ã„ã†ã‹è«–ç†æ¼”ç®—å­å…¨èˆ¬)~~
~~ãƒ»ã‚¤ãƒ³ã‚¯ãƒªãƒ¡ãƒ³ãƒˆ`++`ã¨ãƒ‡ã‚¯ãƒªãƒ¡ãƒ³ãƒˆ`--`æ¼”ç®—å­~~
ã‚ãŸã‚ŠãŒè¶³ã‚Šãªã•ãã†


[10/24/2022 11:44 PM] mikiken#5554
ã¨ã„ã†ã“ã¨ã§ä»Šé€±ã¯ã“ã®è¾ºã‚’è¿½åŠ ã—ã¦ã„ããŸã„


[10/24/2022 11:45 PM] mikiken#5554
ã‚ã¨ãƒã‚¤ãƒ³ã‚¿ã‚’è¿”ã‚Šå€¤ã¨ã™ã‚‹ã‚ˆã†ãªãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ãŒå…¨ç„¶ãªã„æ°—ãŒã™ã‚‹ã®ã§ã€ãã‚Œã‚‚è¿½åŠ ã—ãŸã„


[10/25/2022 1:09 PM] mikiken#5554
ã‚ã¨`sizeof(int)`ã¿ãŸã„ãªè¨˜æ³•ãŒæœªå®Ÿè£…


[10/25/2022 1:46 PM] mikiken#5554
https://zenn.dev/kaityo256/articles/increment_operators

{Embed}
https://zenn.dev/kaityo256/articles/increment_operators
ã‚¤ãƒ³ã‚¯ãƒªãƒ¡ãƒ³ãƒˆæ¼”ç®—å­ã¨ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã®æ°—æŒã¡
https://images-ext-1.discordapp.net/external/2hQcq75oaK53d8oF9NABWkucZBvABQ6kQISpdUd_BH8/https/res.cloudinary.com/zenn/image/upload/s--j0O_bGLi--/co_rgb%3A222%252Cg_south_west%252Cl_text%3Anotosansjp-medium.otf_37_bold%3A%2525E3%252583%2525AD%2525E3%252583%25259C%2525E5%2525A4%2525AA%252Cx_203%252Cy_98/c_fit%252Cco_rgb%3A222%252Cg_north_west%252Cl_text%3Anotosansjp-medium.otf_70_bold%3A%2525E3%252582%2525A4%2525E3%252583%2525B3%2525E3%252582%2525AF%2525E3%252583%2525AA%2525E3%252583%2525A1%2525E3%252583%2525B3%2525E3%252583%252588%2525E6%2525BC%252594%2525E7%2525AE%252597%2525E5%2525AD%252590%2525E3%252581%2525A8%2525E3%252582%2525B3%2525E3%252583%2525B3%2525E3%252583%252591%2525E3%252582%2525A4%2525E3%252583%2525A9%2525E3%252581%2525AE%2525E6%2525B0%252597%2525E6%25258C%252581%2525E3%252581%2525A1%252Cw_1010%252Cx_90%252Cy_100/g_south_west%252Ch_90%252Cl_fetch%3AaHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vemVubi9pbWFnZS9mZXRjaC9zLS1semRkTWZ2Ry0tL2NfbGltaXQlMkNmX2F1dG8lMkNmbF9wcm9ncmVzc2l2ZSUyQ3FfYXV0byUyQ3dfNzAvaHR0cHM6Ly9zdG9yYWdlLmdvb2dsZWFwaXMuY29tL3plbm4tdXNlci11cGxvYWQvYXZhdGFyLzgzOGNiYTA0OWMuanBlZw%3D%3D%252Cr_max%252Cw_90%252Cx_87%252Cy_72/v1627274783/default/og-base_z4sxah.png


[11/08/2022 7:39 PM] mikiken#5554
æœªåˆæœŸåŒ–ã®ãƒã‚¤ãƒ³ã‚¿ã‚’å‚ç…§ã™ã‚‹ã®ã¯æœªå®šç¾©å‹•ä½œã ãŒã€ãã®å ´åˆã‚‚è€ƒæ…®ã—ãŸå®Ÿè£…
https://github.com/karintou8710/kcc/commit/8d56aea5861c72eae36a723aa662123268d67c2c

{Embed}
https://github.com/karintou8710/kcc/commit/8d56aea5861c72eae36a723aa662123268d67c2c
Fix 'logical and' and 'logical or' bug Â· karintou8710/kcc@8d56aea
https://images-ext-1.discordapp.net/external/DLNgU5QQMbzkJYWVD-cL7jZx7m8PSjomCahIyOpp8dU/https/opengraph.githubassets.com/f9334fb266b23efb68634e93238acf1fb8791560b14205ea3815bfbf0afb4b76/karintou8710/kcc/commit/8d56aea5861c72eae36a723aa662123268d67c2c


[11/08/2022 7:40 PM] mikiken#5554
https://github.com/rui314/chibicc/commit/f30f78175c1fd50c8cdd132ca804573ae0d18453

{Embed}
https://github.com/rui314/chibicc/commit/f30f78175c1fd50c8cdd132ca804573ae0d18453
Add && and || Â· rui314/chibicc@f30f781
https://images-ext-2.discordapp.net/external/x9XnbVPGp1aoYDvflByrrdm1L8eY4k3R5lF815QNumo/https/opengraph.githubassets.com/8b181f61450adf248433b456607e346386d195ac1adc1be153a25d072486ca0e/rui314/chibicc/commit/f30f78175c1fd50c8cdd132ca804573ae0d18453


[11/08/2022 7:41 PM] mikiken#5554
(å·¦è¾ºã§æœªå®šç¾©å‹•ä½œè¸ã‚“ã ã‚‰ã‚»ã‚°ãƒ•ã‚©ã™ã‚‹ã¨ã¯æ€ã†ã‘ã©)


[11/08/2022 7:42 PM] mikiken#5554
ã¨ã‚Šã‚ãˆãšæœªå®šç¾©å‹•ä½œè¸ã¾ãªã‘ã‚Œã°å¤§ä¸ˆå¤«ãªã¯ãšãªã®ã§ã€ä¸€æ—¦ã“ã‚Œã§ã„ã


[11/13/2022 11:16 PM] mikiken#5554
**BNFã®ä¿®æ­£ç‚¹**
ãƒ»é–¢æ•°å®£è¨€ã‚’è¿½åŠ 
ãƒ»`Func_name(void)` ã¿ãŸã„ãªè¨˜æ³•ã«å¯¾å¿œ
ãƒ»é–¢æ•°ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚ãŸã‚Šã®BNFãŒã„ã‚ã„ã‚ã‚¢ãƒ¬


[11/15/2022 2:18 PM] mikiken#5554
~~é–¢æ•°å®£è¨€ã«ä»Šã®ã¨ã“ã‚ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒæ›¸ã‘ãªã„~~ (å¯¾å¿œæ¸ˆ)


[11/15/2022 3:05 PM] mikiken#5554
**Step ?? ã‚«ãƒ³ãƒæ¼”ç®—å­ã‚’è¿½åŠ ã™ã‚‹**


[11/15/2022 3:17 PM] mikiken#5554


{Attachments}
https://cdn.discordapp.com/attachments/1003859454191751178/1041960148983357470/image.png


[11/15/2022 3:18 PM] mikiken#5554
ã“ã‚“ãªæ„Ÿã˜ã®æ§‹æ–‡æœ¨ã«ãƒ‘ãƒ¼ã‚¹ã—ãªã„ã¨ã„ã‘ãªã„ã¯ãš


[12/01/2022 4:22 PM] mikiken#5554
**ä¾‹ã®ãƒ‰ãƒ¼ãƒŠãƒ„ã‚’å‹•ã‹ã™**


[12/01/2022 4:22 PM] mikiken#5554


{Attachments}
https://cdn.discordapp.com/attachments/1003859454191751178/1047774726442991616/image.png


[12/01/2022 4:37 PM] mikiken#5554
**ç ´æ»…ã®åˆƒ() ~ç„¡é™ãƒ‡ãƒãƒƒã‚°ç·¨~**


[12/01/2022 4:37 PM] mikiken#5554
åŸå› èª¿æŸ»


[12/01/2022 4:37 PM] mikiken#5554
ã¾ãšã€`z[o]`ã®ã¨ã“ã‚ã§è½ã¡ã¦ãã†


[12/01/2022 4:38 PM] mikiken#5554
`o`ã®å€¤ã‚’èª¿ã¹ã¦ã¿ã‚‹ã¨ã€å®šç¾©ã—ãŸé…åˆ—ã®è¦ç´ æ•°ã‚’å¤§å¹…ã«ä¸Šå›ã£ã¦ã„ã‚‹ã®ã§ã€ã“ã‚Œã®ã›ã„ã§å¤‰ãªãƒ¡ãƒ¢ãƒªã‚¢ã‚¯ã‚»ã‚¹ãŒç™ºç”Ÿã—ã€ã‚»ã‚°ãƒ•ã‚©ã—ã¦ã‚‹ã£ã½ã„


[12/01/2022 4:39 PM] mikiken#5554
ã¨ã„ã†ã“ã¨ã§å„ç¨®å¤‰æ•°ã®å€¤ã«ã¤ã„ã¦ã€ccã®å‡ºåŠ›ã¨9ccã®å‡ºåŠ›ã‚’æ¯”è¼ƒã—ã¦ã¿ã‚‹ã¨ã€2ã‚¹ãƒ†ãƒƒãƒ—ç›®ã§æ—¢ã«`N`ã®å€¤ãŒç•°ãªã£ã¦ã„ã‚‹ã“ã¨ãŒåˆ†ã‹ã‚‹(ä¸Šè¨˜ç”»åƒå‚ç…§)


[12/01/2022 4:39 PM] mikiken#5554
(æã‚‰ã)`N`ã®å€¤ãŒãƒã‚°ã£ã¦ã‚‹ã“ã¨ã§ã€å¾Œã€…`o`ã‚‚å¤‰ãªå€¤ã«ãªã£ã¦ã‚‹


[12/01/2022 4:40 PM] mikiken#5554
ã¨ã„ã†ã“ã¨ã§
```C
N = 8 * (m(m(l, r) - m(m(w, q), p), u) - m(m(w, r), p) - m(l, q) - m(m(e, v), p)) / s;
```
ã®å„ã‚ªãƒšãƒ©ãƒ³ãƒ‰ã”ã¨ã«å€¤ã‚’å‡ºåŠ›ã—ã¦ã¿ãŸ


[12/01/2022 4:41 PM] mikiken#5554


{Attachments}
https://cdn.discordapp.com/attachments/1003859454191751178/1047779556779634718/message.txt


[12/01/2022 4:42 PM] mikiken#5554
`op1`ã®å€¤ãŒãƒã‚°ã£ã¦ã‚‹


[12/01/2022 4:55 PM] mikiken#5554
ã•ã‚‰ã«`op1`ã‚’åˆ†è§£


[12/01/2022 4:55 PM] mikiken#5554


{Attachments}
https://cdn.discordapp.com/attachments/1003859454191751178/1047783018573602816/message.txt


[12/01/2022 4:56 PM] mikiken#5554
ã¡ãªã¿ã«ã“ã“ã¾ã§ã€ã“ã‚“ãªæ„Ÿã˜ã§å±•é–‹ã—ã¦ã„ã‚‹
```C
        printf("<< %d >>\n", ++count);
        if (count >= 90)
          return 0;

        // N = 8 * (m(m(l, r) - m(m(w, q), p), u) - m(m(w, r), p) - m(l, q) - m(m(e, v), p)) / s;
        int opp1;
        int opp2;
        int diff;
        int op1;
        int op2;
        int op3;
        int op4;

        opp1 = m(l, r);
        opp2 = m(m(w, q), p);
        diff = opp1 - opp2;
        //op1 = m(m(l, r) - m(m(w, q), p), u);
        op1 = m(diff, u);
        op2 = m(m(w, r), p);
        op3 = m(l, q);
        op4 = m(m(e, v), p);
        N = 8 * (op1 - op2 - op3 - op4) / s;

        printf("opp1 = %d\n", opp1);
        printf("opp2 = %d\n", opp2);
        printf("diff = %d\n", diff);
        printf("u    = %d\n", u);
        printf("op1  = %d\n\n", op1);

        /*
        printf("op1 = %d\n", op1);
        printf("op2 = %d\n", op2);
        printf("op3 = %d\n", op3);
        printf("op4 = %d\n", op4);
        printf("N   = %d\n\n", N);
        */
        /*
        printf("f = %d\n", f);
        printf("g = %d\n", g);
        printf("t = %d\n", t);
        printf("x = %d\n", x);
        printf("y = %d\n", y);
        printf("o = %d\n", o);
        printf("N = %d\n\n", N);
        */
```


[12/01/2022 4:59 PM] mikiken#5554
é–¢æ•°`int m(int a, int b);`ãŒè¿”ã—ã¦ã„ã‚‹å€¤ãŒãŠã‹ã—ã„ã¨è€ƒãˆã‚‰ã‚Œã‚‹


[12/01/2022 5:24 PM] mikiken#5554
ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰```C
int m(int a, int b) {
  return (a * b + 5000) / 10000;
}

int printf();

int main() {
  printf("m(   0, 10000)  = %d\n", m(0, 10000));
  printf("m(-200, 10000)  = %d\n", m(-200, 10000));
  printf("m(-400, 10000)  = %d\n", m(-400, 10000));
  printf("m(-600, 10000)  = %d\n", m(-600, 10000));
  printf("m(-800, 10000)  = %d\n", m(-800, 10000));
  printf("m(-999, 10000)  = %d\n", m(-999, 10000));
  printf("m(-1198, 10000) = %d\n", m(-1198, 10000));
  printf("m(-1397, 10000) = %d\n", m(-1397, 10000));
  printf("m(-1595, 10000) = %d\n", m(-1595, 10000));
  printf("m(-1792, 10000) = %d\n", m(-1792, 10000));
  printf("m(-1989, 10000) = %d\n", m(-1989, 10000));

  return 0;
}
```


[12/01/2022 5:25 PM] mikiken#5554
å‡ºåŠ›çµæœ
```
m(   0, 10000)  = 0                                             m(   0, 10000)  = 0
m(-200, 10000)  = 429297                                      | m(-200, 10000)  = -199
m(-400, 10000)  = 429097                                      | m(-400, 10000)  = -399
m(-600, 10000)  = 428897                                      | m(-600, 10000)  = -599
m(-800, 10000)  = 428697                                      | m(-800, 10000)  = -799
m(-999, 10000)  = 428498                                      | m(-999, 10000)  = -998
m(-1198, 10000) = 428299                                      | m(-1198, 10000) = -1197
m(-1397, 10000) = 428100                                      | m(-1397, 10000) = -1396
m(-1595, 10000) = 427902                                      | m(-1595, 10000) = -1594
m(-1792, 10000) = 427705                                      | m(-1792, 10000) = -1791
m(-1989, 10000) = 427508                                      | m(-1989, 10000) = -1988
```


[12/01/2022 5:48 PM] mikiken#5554
`m`ã®ã©ã“ã§äº‹æ•…ã£ã¦ã‚‹ã‹èª¿æŸ»
```C
int printf();

int m(int a, int b) {
  printf("a = %d\n", a);
  printf("b = %d\n", b);

  int product;
  int sum;
  int div;

  product = a * b;
  sum = product + 5000;
  div = sum / 10000;

  printf("product = %d\n", product);
  printf("sum     = %d\n", sum);
  printf("div      = %d\n", div);
  return div;
  //return (a * b + 5000) / 10000;
}

int main() {
  printf("m(-200, 10000)  = %d\n", m(-200, 10000));
  /*
  printf("m(   0, 10000)  = %d\n", m(0, 10000));

  printf("m(-400, 10000)  = %d\n", m(-400, 10000));
  printf("m(-600, 10000)  = %d\n", m(-600, 10000));
  printf("m(-800, 10000)  = %d\n", m(-800, 10000));
  printf("m(-999, 10000)  = %d\n", m(-999, 10000));
  printf("m(-1198, 10000) = %d\n", m(-1198, 10000));
  printf("m(-1397, 10000) = %d\n", m(-1397, 10000));
  printf("m(-1595, 10000) = %d\n", m(-1595, 10000));
  printf("m(-1792, 10000) = %d\n", m(-1792, 10000));
  printf("m(-1989, 10000) = %d\n", m(-1989, 10000));
  */

  return 0;
}
```


[12/01/2022 6:50 PM] mikiken#5554
`m`ã®ã©ã“ã§äº‹æ•…ã£ã¦ã‚‹ã‹èª¿æŸ»
```C
int printf();

int m(int a, int b) {
  printf("a = %d\n", a);
  printf("b = %d\n", b);

  int product;
  int sum;
  int div;

  product = a * b;
  sum = product + 5000;
  div = sum / 10000;

  printf("product = %d\n", product);
  printf("sum     = %d\n", sum);
  printf("div      = %d\n", div);
  return div;
  //return (a * b + 5000) / 10000;
}

int main() {
  printf("m(-200, 10000)  = %d\n", m(-200, 10000));
  /*
  printf("m(   0, 10000)  = %d\n", m(0, 10000));

  printf("m(-400, 10000)  = %d\n", m(-400, 10000));
  printf("m(-600, 10000)  = %d\n", m(-600, 10000));
  printf("m(-800, 10000)  = %d\n", m(-800, 10000));
  printf("m(-999, 10000)  = %d\n", m(-999, 10000));
  printf("m(-1198, 10000) = %d\n", m(-1198, 10000));
  printf("m(-1397, 10000) = %d\n", m(-1397, 10000));
  printf("m(-1595, 10000) = %d\n", m(-1595, 10000));
  printf("m(-1792, 10000) = %d\n", m(-1792, 10000));
  printf("m(-1989, 10000) = %d\n", m(-1989, 10000));
  */

  return 0;
}
```


[12/01/2022 6:51 PM] mikiken#5554
ç¬¦å·æ‹¡å¼µã‚’å‹ã®ã‚µã‚¤ã‚ºã«ã‚ˆã£ã¦å¤‰ãˆã‚‹å¿…è¦ãŒã‚ã‚‹ã£ã½ã„


[12/01/2022 6:52 PM] mikiken#5554
https://sozysozbot.github.io/seccamp-2022-c-compiler-seminar/#permalink_4b6f8c795bc832e32c3a6745ceb68082


[12/01/2022 6:52 PM] mikiken#5554
https://twitter.com/lemolatoon1/status/1598236585547350016

{Embed}
lemolatoon (@lemolatoon1)
https://twitter.com/lemolatoon1/status/1598236585547350016
@mikikeen ã“ã‚Œåƒ•ã‚‚ãƒã‚°ã‚‰ã›ãŸã‚“ã§ã™ãŒã€ãƒ­ã‚°ã‚’ã€Œå‰²ã‚Šç®—ã€ãªã©ã§æ¤œç´¢ã™ã‚‹ã¨å½“æ™‚ã®ä¼šè©±ã§ãã®ã“ã¨ã«ã¤ã„ã¦è©±ã—ã¦ã¾ã™ã€‚https://t.co/pCdLWPAyRm
Twitter


[12/01/2022 6:53 PM] mikiken#5554
å‹ã®ã‚µã‚¤ã‚ºã«å¿œã˜ã¦ç¬¦å·æ‹¡å¼µã™ã‚‹é–¢æ•°æ›¸ã„ãŸã‚‰ã€ãƒ‰ãƒ¼ãƒŠãƒ„å‡ºãŸ
(ãŸã ã€ã¾ã ã‚»ã‚°ãƒ•ã‚©ã™ã‚‹)
https://twitter.com/mikikeen/status/1598726498948591616

{Attachments}
https://cdn.discordapp.com/attachments/1003859454191751178/1047812743664783360/image.png

{Embed}
mikiken (@mikikeen)
https://twitter.com/mikikeen/status/1598726498948591616
è‡ªä½œã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã€ä¼å®¶ã®å®åˆ€â€ printfãƒ‡ãƒãƒƒã‚°â€ ã—ã¦ãŸã‚‰ã€printfã®æœ‰ç„¡ã§æŒ™å‹•å¤‰ã‚ã£ã¦é ­æŠ±ãˆã¦ã‚‹
Likes
149
Twitter


[12/12/2022 7:50 PM] mikiken#5554
ä¹…ã€…ã«ãƒ‡ãƒãƒƒã‚°ã®ç¶šãã‚’ã‚„ã£ã¦ã„ãï½ï½


[12/12/2022 7:51 PM] mikiken#5554
ã¨ã‚Šã‚ãˆãš
ãƒ»ç¬¦å·æ‹¡å¼µç›´ã—ãŸã‚„ã¤
ãƒ»é…åˆ—ã‚’ãƒã‚¤ãƒ³ã‚¿ã«ã‚­ãƒ£ã‚¹ãƒˆã—å¿˜ã‚Œã¦ãŸã‚„ã¤ã‚’è¿½åŠ 
ã‚’commitã—ãŸ


[12/12/2022 7:52 PM] mikiken#5554
ãã‚Œã§ä½•ãŒã©ã†ãªã£ã¦ã„ãŸã‹ã€å¿˜ã‚Œã¦ãŸã®ã§MakeFileã®å·®åˆ†ã‚‚discardã—ãŸ


[12/12/2022 7:52 PM] mikiken#5554
codegen.cã®ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã§ã„ã„æ„Ÿã˜ã«nodeã®ç¨®é¡ã‚’è¡¨ç¤ºã™ã‚‹ã‚„ã¤ã¯ãã®ã¾ã¾ç½®ã„ã¦ã‚ã‚‹


[12/12/2022 7:53 PM] mikiken#5554
https://github.com/hsjoihs/c-compiler/blob/17f53331a19e37594d07e69cc70bc71ae30eb6f4/misc/donut_donut.c

{Embed}
https://github.com/hsjoihs/c-compiler/blob/17f53331a19e37594d07e69cc70bc71ae30eb6f4/misc/donut_donut.c
c-compiler/donut_donut.c at 17f53331a19e37594d07e69cc70bc71ae30eb6f...
seccamp2018 c compiler. Contribute to hsjoihs/c-compiler development by creating an account on GitHub.
https://images-ext-1.discordapp.net/external/vLLxuiw2QPIVJJL3UOAtcL5b-2yN48BTZnHG5BhWzYM/https/opengraph.githubassets.com/bb4c508b95c6221a9f1d8542652c6e03ea8ffa887d98ad3c322ba72dbe3d95aa/hsjoihs/c-compiler


[12/12/2022 7:54 PM] mikiken#5554
donutifyã•ã‚Œã¦ã‚‹ã‚„ã¤ã‚’æ™®é€šã«æˆ»ã—ã¦åˆæœŸåŒ–å¼ã‚’æ’é™¤ã—ã¦ã€ä¸‹ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æ¶ˆå»ã—ãŸdonut.cãŒã“ã‚Œ


[12/12/2022 7:55 PM] mikiken#5554


{Attachments}
https://cdn.discordapp.com/attachments/1003859454191751178/1051814513470603264/donut_basic.c


[12/12/2022 7:55 PM] mikiken#5554
ã¨ã‚Šã‚ãˆãš9ccã§ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—ã¦ã¿ã‚‹


[12/12/2022 7:55 PM] mikiken#5554
usleepã§ã‚»ã‚°ãƒ•ã‚©ã—ã¦ã‚‹


[12/12/2022 7:56 PM] mikiken#5554
ã“ã†ã„ã†ã®
```C
void usleep();
int printf();

int main() {
  usleep(2000000);
  printf("Now testing usleep() calling.\n");
}
```


[12/12/2022 7:56 PM] mikiken#5554
ãŒã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã§ãã‚‹ã‹ç¢ºèªã—ãŸã¨ã“ã‚ã€ã“ã‚Œã¯é€šã‚‹


[12/14/2022 2:36 AM] mikiken#5554
```
Program received signal SIGSEGV, Segmentation fault.
[----------------------------------registers-----------------------------------]
RAX: 0x7fffff7feffc 
RBX: 0x2 
RCX: 0xc8 
RDX: 0x270e 
RSI: 0x270e 
RDI: 0xffffe7ea 
RBP: 0x7fffff7ff000 --> 0x7fffff7ff048 --> 0x7fffffffddd0 --> 0x0 
RSP: 0x7fffff7feff0 
RIP: 0x555555555165 (<m+12>:    mov    DWORD PTR [rax],edi)
R8 : 0xa ('\n')
R9 : 0x3 
R10: 0x555555558010 --> 0x7e2d2c2e00485b1b 
R11: 0x246 
R12: 0x555555555070 (<_start>:  endbr64)
R13: 0x7fffffffdec0 --> 0x1 
R14: 0x0 
R15: 0x0
EFLAGS: 0x10206 (carry PARITY adjust zero sign trap INTERRUPT direction overflow)
[-------------------------------------code-------------------------------------]
   0x55555555515a <m+1>:        mov    rbp,rsp
   0x55555555515d <m+4>:        sub    rsp,0x10
   0x555555555161 <m+8>:        lea    rax,[rbp-0x4]
=> 0x555555555165 <m+12>:       mov    DWORD PTR [rax],edi
   0x555555555167 <m+14>:       lea    rax,[rbp-0x8]
   0x55555555516b <m+18>:       mov    DWORD PTR [rax],esi
   0x55555555516d <m+20>:       lea    rdi,[rbp-0x4]
   0x555555555171 <m+24>:       push   rdi
[------------------------------------stack-------------------------------------]
Invalid $SP address: 0x7fffff7feff0
[------------------------------------------------------------------------------]
Legend: code, data, rodata, value
Stopped reason: SIGSEGV
m () at tmp.s:18
18        mov DWORD PTR [rax], edi
gdb-peda$ q
```


[12/14/2022 1:15 PM] mikiken#5554
ãƒ¯ãƒ³ãƒãƒ£ãƒ³åŸå› ã“ã‚Œã‹?


[12/14/2022 1:15 PM] mikiken#5554
```
mikiken@DESKTOP-CM4259U:~/compiler/9cc$ ulimit -a
core file size          (blocks, -c) 0
data seg size           (kbytes, -d) unlimited
scheduling priority             (-e) 0
file size               (blocks, -f) unlimited
pending signals                 (-i) 31257
max locked memory       (kbytes, -l) 64
max memory size         (kbytes, -m) unlimited
open files                      (-n) 1048576
pipe size            (512 bytes, -p) 8
POSIX message queues     (bytes, -q) 819200
real-time priority              (-r) 0
stack size              (kbytes, -s) 8192
cpu time               (seconds, -t) unlimited
max user processes              (-u) 31257
virtual memory          (kbytes, -v) unlimited
file locks                      (-x) unlimited
```


[12/14/2022 1:18 PM] mikiken#5554


{Attachments}
https://cdn.discordapp.com/attachments/1003859454191751178/1052439399419347024/image.png


[12/14/2022 1:18 PM] mikiken#5554
ã¯ã„æ­£è§£ï½ï½ï½


[12/14/2022 4:55 PM] mikiken#5554
https://youreingaming.blog.fc2.com/blog-entry-92.html

{Embed}
https://youreingaming.blog.fc2.com/blog-entry-92.html
C/C++ã§ãƒ‡ã‚«ã„é…åˆ—ãŒSegmentation faultã‚’åãã¨ãã«èª­ã‚€è¨˜äº‹ - PCé–¢é€£
é¡›æœ«è‡ªä½œã®modintãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ãƒ†ã‚¹ãƒˆãŒã¦ã‚‰ã€\( 10^6 \times 10 \)ã‚µã‚¤ã‚ºã®é…åˆ—ã‚’å®£è¨€ã—ã¦ã¿ãŸã‚‰segmentation faultãŒå‡ºãŸã€‚è¨ˆç®—é€”ä¸­ã«ã‚ªãƒ¼ãƒãƒ¼ãƒ•ãƒ­ãƒ¼ã‚’èµ·ã“ã™ã‚ˆã†ãªå‡¦ç†(ä¾‹ãˆã°modã‚’å–ã‚‹å‰ã®å€¤ãŒlong longã®maxã‚’è¶…ãˆã¦ã„ã‚‹ã¨ã‹)ã‚’è¡Œã£ã¦ã„ã‚‹ã‚ã‘ã§ã¯ãªã„ã®ã§ãŠãã‚‰ããƒ¡ãƒ¢ãƒªé–¢é€£ã®ã‚¨ãƒ©ãƒ¼ã§ã‚ã‚‹ã¨æ¨æ¸¬ã™ã‚‹ã€‚åŒæ§˜ã®ã‚µã‚¤ã‚ºã®é…åˆ—ã‚’Windowsç’°å¢ƒã§MinGW G++ã‚’ç”¨ã„ã¦ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—ã¦å®Ÿè¡Œã—ã¦ã‚‚æ­£å¸¸ã«é€šã‚‹ã®ã§ãŠãã‚‰ãLinux(Ubuntu on WSL...


[12/14/2022 5:37 PM] mikiken#5554
ãªã‚“ã‹`usleep.c`ãŒãªã„ã£ã¦è¨€ã‚ã‚Œã¦ã‚‹ã£ã½ã„?


[12/14/2022 5:37 PM] mikiken#5554


{Attachments}
https://cdn.discordapp.com/attachments/1003859454191751178/1052504531142979605/message.txt


[12/21/2022 12:39 AM] mikiken#5554
ã‚¹ã‚¿ãƒƒã‚¯ã®16byte-alignmentãŒå´©ã‚Œã¦ã„ã‚‹


[12/21/2022 12:39 AM] mikiken#5554
```
.L.end.3:
  lea rdi, [rbp-8844]
  push rdi
  lea rdi, [rbp-8844]
  push rdi
  pop rdi
  mov eax, DWORD PTR [rdi]
  push rax
  push 1
  pop rbx
  pop rax
  add eax, ebx
  push rax
  pop rax
  pop rdi
  mov DWORD PTR [rdi], eax
  push rax
  push 1
  pop rbx
  pop rax
  sub eax, ebx
  push rax
  pop rax
  lea rdi, [rbp-8840]
  push rdi
  lea rdi, [rbp-8836]
  push rdi
  lea rdi, [rbp-8804]
  push rdi
  pop rdi
  mov eax, DWORD PTR [rdi]
  push rax
  push 2
  pop rbx
  pop rax
  sub eax, ebx
  push rax
  push 200
  pop rcx
  pop rdx
  pop rsi
  pop rdi
  mov al, 0
  # stack_align % 16 = -8 // => 0
  call a
  push rax
  jmp .L.begin.2
.L.end.2:
```


[12/21/2022 12:41 AM] mikiken#5554
æœ€åˆã«ãŠã‹ã—ããªã£ã¦ã‚‹ã®ãŒã€`tmp.s`ã®1133è¡Œç›®ã§ã€ã“ã‚Œã«å¯¾å¿œã™ã‚‹ã®ã¯`donut.c`ã®50è¡Œç›®ã®
```C
 for (j = 0; j < 314; j++, a(&e, &w, s - 2, 200)) {
```
é–¢æ•°`a`ã‚’å‘¼ã³å‡ºã™éƒ¨åˆ†ã ã¨è€ƒãˆã‚‰ã‚Œã‚‹


[01/08/2023 11:13 PM] mikiken#5554
**~1ãƒ¶æœˆçµŒéğŸ˜‡~**
`for(expr; expr; expr)`ã®`expr`ã®å€¤ãŒpushã•ã‚ŒãŸã¾ã¾ã«ãªã£ã¦ãŸã®ãŒåŸå› 


[01/11/2023 1:30 AM] mikiken#5554


{Attachments}
https://cdn.discordapp.com/attachments/1003859454191751178/1062407993406279771/f04e41a6-d9a3-4290-aed2-7004401a8058.png


[01/11/2023 1:30 AM] mikiken#5554


{Attachments}
https://cdn.discordapp.com/attachments/1003859454191751178/1062408101124386816/9ca27d31-95de-4b22-8805-68eb5697cf8d.png


[02/14/2023 6:38 PM] mikiken#5554
**å†ã³1ãƒ¶æœˆçµŒé**


[02/14/2023 6:38 PM] mikiken#5554
https://twitter.com/mikikeen/status/1625040676474982400

{Embed}
mikiken (@mikikeen)
https://twitter.com/mikikeen/status/1625040676474982400
1ãƒ¶æœˆã¶ã‚Šã«è‡ªä½œã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã®ã‚³ãƒ¼ãƒ‰è¦‹ã¦ã‚‹ã‘ã©ã€ä½•ã‚’ã—ã‚ˆã†ã¨ã—ã¦ãŸã‹å¿˜ã‚ŒãŸ
Twitter


[02/14/2023 6:39 PM] mikiken#5554
https://twitter.com/mikikeen/status/1625040952728645633

{Embed}
mikiken (@mikikeen)
https://twitter.com/mikikeen/status/1625040952728645633
ãƒ­ãƒ¼ã‚«ãƒ«ãªé…åˆ—ã®åˆæœŸåŒ–å¼ã‚’å®Ÿè£…ã—ã‚ˆã†ã¨ã—ã¦ãŸã£ã½ã„
Twitter


[02/14/2023 6:39 PM] mikiken#5554
ã¨ã„ã†ã‚ã‘ã§ã‚„ã£ã¦ã„ã


[02/14/2023 6:40 PM] mikiken#5554
ã“ã‚“ãªæ„Ÿã˜ã®ã‚³ãƒ¼ãƒ‰ã‚’è¿½åŠ ã—ã€
```C
Node *array_init(Function *func, Token *ident, Token *tok) {
  Node head;
  Node *cur = &head;
  for (int offset = 0; !consume(tok, TK_RIGHT_BRACE); offset++) {
    cur = cur->next = new_node(ND_STMT);
    cur->body = new_node(ND_ASSIGN);
    cur->body->lhs = new_binary_node(ND_DEREF, new_binary_node(ND_ADD, var_node(func, ident), new_num_node(offset)), NULL);
    cur->body->rhs = assign(func, tok);
    if (consume(tok, TK_RIGHT_BRACE))
      return head.next;
    expect(tok, TK_COMMA);
  }
  return head.next;
}
```


[02/14/2023 6:40 PM] mikiken#5554
ã“ã†ã„ã†ã‚³ãƒ¼ãƒ‰ãŒé€šã‚‹ã‚ˆã†ã«ãªã£ãŸ
```C
int array_test13() {
  int a[5] = {1, 2, 3, 4, 5};
  int sum = 0;
  for (int i = 0; i < 5; i++)
    sum += a[i];
  return sum;
}
```


[02/14/2023 6:40 PM] mikiken#5554
ã‚±ãƒ„ã‚«ãƒ³ãƒãŒã‚ã£ã¦ã‚‚é€šã‚‹å®Ÿè£…ã«ãªã£ã¦ã‚‹


[02/14/2023 6:41 PM] mikiken#5554
ã‚ã¨å®Ÿè£…ã—ãªã„ã¨ã„ã‘ãªã„ä»•æ§˜ã¨ã—ã¦ã¯ã€


[02/14/2023 6:41 PM] mikiken#5554
é…åˆ—ã®é•·ã•ã‚’æ˜ç¤ºçš„ã«æ›¸ã‹ãšã«åˆæœŸåŒ–ã™ã‚‹ã‚„ã¤
```C
int arr[] = {1,2,3};
```


[02/14/2023 6:43 PM] mikiken#5554
ã‚ã¨ã¯åˆæœŸåŒ–å¼ãŒä¸€éƒ¨ã—ã‹ä¸ãˆã‚‰ã‚Œã¦ãªã„å ´åˆã«ã€æ®‹ã‚Šã®è¦ç´ ã‚’0åŸ‹ã‚ã™ã‚‹ã‚„ã¤ã¨ã‹
```C
int x[5] = {1, 2, 3}; // ã“ã‚Œã¯ä¸‹ã¨ç­‰ä¾¡
int x[5] = {1, 2, 3, 0, 0};
```


[02/14/2023 6:45 PM] mikiken#5554
ãã‚‚ãã‚‚ã€ãŸã é…åˆ—ã‚’å®£è¨€ã—ãŸã ã‘ã®ã¨ãã£ã¦ã€åˆæœŸåŒ–ã•ã‚ŒãŸã£ã‘?
```C
int arr[3]; // ã“ã‚Œã®åˆæœŸå€¤ã©ã†ãªã£ã¦ã‚‹?
```


[02/14/2023 6:48 PM] mikiken#5554
ã‚ã¨ã¯ã€å®šç¾©ã—ãŸãƒ‡ã‚«ã•ä»¥ä¸Šã®è¦ç´ ã‚’å‚ç…§ã—ã‚ˆã†ã¨ã—ãŸã¨ãã«è­¦å‘Šå‡ºã™ã¨ã‹
(gccã§è©¦ã—ãŸã‚‰warningã«ãªã£ãŸã®ã§ã€æœªå®šç¾©å‹•ä½œã£ã½ã„?)â†ç¢ºèªãŒå¿…è¦


[02/15/2023 2:21 PM] mikiken#5554
ãƒã‚¤ãƒ³ã‚¿ã®é…åˆ—ã®ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹å…¥ã‚Œã¦ãªã„ãªã€ãã†ã„ãˆã°


[02/15/2023 3:06 PM] mikiken#5554
ã¨ã‚Šã‚ãˆãšé…åˆ—ã®é•·ã•ã‚’æ˜ç¤ºçš„ã«æ›¸ã‹ãªã„ã‚„ã¤ã‚’å®Ÿè£…ã—ã¦ã„ã


[02/15/2023 5:59 PM] mikiken#5554
é©å½“ã«ã‚³ãƒ¼ãƒ‰è¶³ã—ãŸã‚‰ã€å¤‰æ•°ã®ã‚ªãƒ•ã‚»ãƒƒãƒˆã®å‡¦ç†æ›¸ãå¿˜ã‚ŒãŸã£ã½ãã¦ã€å‡ºåŠ›ã—ãŸã‚¢ã‚»ãƒ³ãƒ–ãƒªãŒã‚»ã‚°ãƒ•ã‚©ã™ã‚‹


[02/15/2023 9:54 PM] mikiken#5554
ãƒ†ã‚¹ãƒˆã§ã‚³ã‚±ã¦ã‚‚ã€ä»–ã®ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã‚‚æµã›ã‚‹ã‚ˆã†ã«ã—ãŸã„ã‹ã‚‚


[02/15/2023 11:34 PM] mikiken#5554
~~ND_LVARã£ã¦ã„ã†Nodekindã€å®Ÿè³ªä½¿ã£ã¦ãªã„ã‹ã‚‰æŠ¹æ¶ˆã—ãŸã•ã‚ã‚‹ãª~~
(è¿½è¨˜) `int a[3];`ã¿ãŸã„ãªæ„Ÿã˜ã§å®£è¨€ã®ã¿ã‚’è¡Œã†å ´åˆã€æœ¨æ§‹é€ ã®è‘‰ã«ã‚ãŸã‚‹nodeãŒãªããªã£ã¦ã—ã¾ã†ã®ã§ã€ã‚ã£ãŸæ–¹ãŒä¾¿åˆ©


[02/16/2023 5:12 PM] mikiken#5554
æœ¬æ¥å‡ºåŠ›ã•ã‚Œã‚‹ã¹ãã‚¢ã‚»ãƒ³ãƒ–ãƒªã¨ç¾çŠ¶å‡ºåŠ›ã•ã‚Œã¦ã„ã‚‹ã‚‚ã®ã¨ã®å·®åˆ†


[02/16/2023 5:12 PM] mikiken#5554


{Attachments}
https://cdn.discordapp.com/attachments/1003859454191751178/1075691133444825109/message.txt


[02/17/2023 9:19 PM] mikiken#5554
é…åˆ—ã®é•·ã•ã‚’çœç•¥ã™ã‚‹è¨˜æ³•ã‚’ã‚µãƒãƒ¼ãƒˆ
https://github.com/mikiken/9cc/commit/7335f8135ffd28916d86c738c526180645331b50

{Embed}
https://github.com/mikiken/9cc/commit/7335f8135ffd28916d86c738c526180645331b50
Allow to omit array length if an initializer is given Â· mikiken/9cc...
https://images-ext-1.discordapp.net/external/0ZGkO16pJj21_oG5LBYbRe-Ot86qBHttua0xfgXwqhA/https/opengraph.githubassets.com/34191cdb8ca6ec6bf682f87ab36f5f98d22718cf75ce344ad7c789fdd3d8f28f/mikiken/9cc/commit/7335f8135ffd28916d86c738c526180645331b50


[02/17/2023 9:20 PM] mikiken#5554
ã‚ã¨åˆæœŸåŒ–ã®è¦ç´ ãŒé…åˆ—ã®é•·ã•ã‚ˆã‚ŠçŸ­ã„å ´åˆã«ã€æ®‹ã‚Šã®è¦ç´ ã«0ã‚’ä»£å…¥ã™ã‚‹ã‚„ã¤ã‚’å®Ÿè£…ã—ãŸ
https://github.com/mikiken/9cc/commit/e45a6b45485e02bdcf6d5855b96f2641cfb337c3

{Embed}
https://github.com/mikiken/9cc/commit/e45a6b45485e02bdcf6d5855b96f2641cfb337c3
Assign 0 to the array elements Â· mikiken/9cc@e45a6b4
if not all elements are given at initalizer
https://images-ext-2.discordapp.net/external/sx2G_DRAumcWnXEOezWZEWtqIsZgoc8izFb3KxcRRDA/https/opengraph.githubassets.com/95b1d0206585e34118ba7c7a919774e26461f559a3e908640495553dcbe4d69d/mikiken/9cc/commit/e45a6b45485e02bdcf6d5855b96f2641cfb337c3


[02/17/2023 9:21 PM] mikiken#5554
https://twitter.com/mikikeen/status/1626471284287897600

{Embed}
mikiken (@mikikeen)
https://twitter.com/mikikeen/status/1626471284287897600
char str[] = "hoge"; ã¿ãŸã„ãªæ§‹æ–‡ã‚’å®Ÿè£…ã—ã‚ˆã†ã¨ã—ãŸãŒã€æ–‡å­—ãƒªãƒ†ãƒ©ãƒ«ã‚’ã¾ã å®Ÿè£…ã—ã¦ã„ãªã‹ã£ãŸ
(æ–‡å­—åˆ—ãƒªãƒ†ãƒ©ãƒ«ã¯ã‚ã‚‹)
Twitter


[02/17/2023 9:21 PM] mikiken#5554
ã¨ã„ã†ã‚ã‘ã§ã€æ–‡å­—ãƒªãƒ†ãƒ©ãƒ«ã‚’å®Ÿè£…ã—ã¦ã„ã


[02/17/2023 9:22 PM] mikiken#5554
å¤§ä½“ã§ããŸã‘ã©ã€ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ãŒ2æ–‡å­—ã¨è§£é‡ˆã•ã‚Œã¦ã‚¨ãƒ©ãƒ¼ã§ã‚‹(ãã‚Œã¯ãã†)


[02/17/2023 9:23 PM] mikiken#5554
ã“ã‚“ãªæ„Ÿã˜ã®ã‚³ãƒ¼ãƒ‰ã‚’è¿½åŠ ã—ã€tok->valã®å€¤ã¨ã™ã‚‹ã“ã¨ã§ã€ã²ã¨ã¾ãšå‹•ãã‚ˆã†ã«ã¯ãªã£ãŸ
```C
char read_escape_char(char *p) {
  switch (*p) {
    case 'a':
      return 7;
    case 'b':
      return 8;
    case 't':
      return 9;
    case 'n':
      return 10;
    case 'v':
      return 11;
    case 'f':
      return 12;
    case 'r':
      return 13;
    case 'e':
      return 27;
    case '"':
      return 34;
    case '\'':
      return 39;
    case '\\':
      return 92;
    default:
      return *p;
  }
}
```


[02/17/2023 9:24 PM] mikiken#5554
æ–‡å­—åˆ—ãƒªãƒ†ãƒ©ãƒ«ã§ã‚‚ä¼¼ãŸã‚ˆã†ãªã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ã—ã¾ã£ã¦ã‚‹ã®ã‚’ã©ã†ã«ã‹ã—ãŸã„


[02/17/2023 9:33 PM] mikiken#5554
å®Ÿã¯æ–‡å­—åˆ—ãƒªãƒ†ãƒ©ãƒ«å®Ÿè£…ã™ã‚‹ã¨ãã€Compiler Explorerã®å‡ºåŠ›ã‚’è¦‹ã‚ˆã†ã¿ã¾ã­ã§çœŸä¼¼ãŸã ã‘ã§ã€ã„ã¾ã„ã¡ä»•çµ„ã¿ãŒåˆ†ã‹ã£ã¦ã„ãªã„ğŸ˜‡


[02/21/2023 3:56 PM] mikiken#5554
ãˆãƒ¼ã¨chibiccã§ã¯ã€æ–‡å­—åˆ—ãƒªãƒ†ãƒ©ãƒ«ã¯dataã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«`char`ã®é…åˆ—ã¨ã—ã¦è¨˜éŒ²ã•ã‚Œã¦ã„ã‚‹ã£ã½ã„


[02/21/2023 4:29 PM] mikiken#5554
ä¸€æ–¹ã€è‡ªåˆ†ã®ã‚„ã¤ã®å ´åˆã€`.string`ã¨ã„ã†è¨˜æ³•ã‚’ä½¿ã£ã¦~~ãŠèŒ¶ã‚’æ¿ã—ã¦~~ã„ã‚‹


[02/21/2023 4:34 PM] mikiken#5554
ã“ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã‚ãŸã‚Šã®è©±ã¯ã€ä»¥ä¸‹ã®URLè¦‹ã‚‹ã¨è‰¯ã•ãã†
http://www.swlab.cs.okayama-u.ac.jp/~nom/lect/p3/what-is-directive.html
https://suu-g.hateblo.jp/entry/20080510/1210408956

{Embed}
suu-g
https://suu-g.hateblo.jp/entry/20080510/1210408956
gasã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã«ã¤ã„ã¦ - suu-g's diary
ã‚¢ã‚»ãƒ³ãƒ–ãƒªã‚³ãƒ¼ãƒ‰ã‚’ã‚¢ã‚»ãƒ³ãƒ–ãƒ«ã™ã‚‹ã¨æ©Ÿæ¢°èªã«ãªã‚‹ã€‚ã“ã†ã„ã†èª¬æ˜ãŒä¸–ã®ä¸­ã˜ã‚ƒã•ã‚Œã¦ã‚‹ã‘ã©ã€ã§ã‚‚ãã‚Œã¯åŠåˆ†ã‚¦ã‚½ã€‚ã‚¢ã‚»ãƒ³ãƒ–ãƒªã‚³ãƒ¼ãƒ‰ã®ä¸­ã§ã‚‚æ©Ÿæ¢°èªã«ç›´æ¥å¯¾å¿œã—ãªã„ã‚‚ã®ãŒã‚ã‚‹ã€‚ãã‚ŒãŒãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã¨å‘¼ã°ã‚Œã¦ã„ã‚‹ã‚‚ã®ã§ã€ãƒ‰ãƒƒãƒˆã‹ã‚‰å§‹ã¾ã‚‹å‘½ä»¤ãŒã“ã‚Œã«ã‚ãŸã‚‹ã€‚ ç–‘ä¼¼å‘½ä»¤ (psuedo-ops) ã¨ã‚‚å‘¼ã°ã‚Œã‚‹ã“ã®ã‚¢ã‚»ãƒ³ãƒ–ãƒ©ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã¯ã€æ©Ÿæ¢°èªã¸ã®ç›´æ¥ã®å¯¾å¿œã§ã¯ãªãã¦ã€ã‚¢ã‚»ãƒ³ãƒ–ãƒ©ï¼ˆGNU asï¼‰ã«å¯¾ã™ã‚‹å‘½ä»¤ã€‚ å‰å›ã®è¨˜äº‹ã§èª¬æ˜ã—ãŸã®ã¯ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«ã¤ã„ã¦ã ã‘ã ã£ãŸã‘ã‚Œã©ã‚‚ã€ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã«ã¯ã‚‚ã£ã¨ã„ã‚ã„ã‚ãªæ„å‘³ãŒã‚ã‚‹ã€‚ ä»¥ä¸‹ã€ãã®å…·ä½“çš„ãªä¾‹ã‚’æŒ™ã’ã¦ã„ãã‚ˆã€‚ æ–‡å­—åˆ—ã‚’é…ç½®ã™ã‚‹ [.ascii .asciz .stâ€¦
https://images-ext-2.discordapp.net/external/N8qYrXlufnSaPq0OkN1_xiaq-3oRO0LFWVc_2GER8aM/https/ogimage.blog.st-hatena.com/12704538227038519244/10328749687242444203/1493731778


[02/21/2023 4:53 PM] mikiken#5554
ç¾åœ¨ã®`find_string_literal_end()`ã®å®Ÿè£…
```C
char *find_string_literal_end(char *start) {
  char *p;
  for (p = start; *p != '\"'; p++) {
    if (*p == '\0' || *p == '\n')
      error_at(start, "æ–‡å­—åˆ—ãƒªãƒ†ãƒ©ãƒ«ãŒé–‰ã˜ã¦ã„ã¾ã›ã‚“");
    if (*p == '\\')
      p++;
  }
  return p;
}

```


[02/21/2023 4:58 PM] mikiken#5554
ã¡ã‚‡ã£ã¨å®Ÿé¨“
```C
int main() {
    char c = '"'; // => Program returned: 34
    return c;
}
```


[02/21/2023 4:58 PM] mikiken#5554
```C
int main() {
    char c = '\"'; // => Program returned: 34
    return c;
}
```


[02/21/2023 5:00 PM] mikiken#5554
```C
int main() {
    // char c = '\'; // => ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼ (2å€‹ç›®ã®ã‚·ãƒ³ã‚°ãƒ«ã‚¯ã‚ªãƒ¼ãƒˆãŒã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã•ã‚Œã¦ã„ã‚‹)
    char c = '\\'; // => Program returned: 92
    return c;
}
```


[02/22/2023 10:33 PM] mikiken#5554


{Attachments}
https://cdn.discordapp.com/attachments/1003859454191751178/1077946228060467341/Java-for.png


[02/22/2023 10:34 PM] mikiken#5554
`find_string_literal_end()`é–¢æ•°ã¯ã€**foræ–‡ã®æ›´æ–°å¼ã¯æ¡ä»¶åˆ¤å®šã®å‰ã«è©•ä¾¡ã•ã‚Œã‚‹**ã“ã¨ã‚’ä¸Šæ‰‹ãåˆ©ç”¨ã—ã¦ã„ã‚‹


[02/23/2023 9:47 PM] mikiken#5554
æ–‡å­—åˆ—ãƒªãƒ†ãƒ©ãƒ«ã®å®Ÿè£…ã‚’ã¨ã‚Šã‚ãˆãšã“ã†ã—ã¦ã¿ãŸ
```C
    // æ–‡å­—åˆ—ãƒªãƒ†ãƒ©ãƒ«ã®å ´åˆ
    if (startswith(p, "\"")) {
      char *start = ++p; // ãƒ€ãƒ–ãƒ«ã‚¯ã‚ªãƒ¼ãƒˆã‚’èª­ã¿é£›ã°ã™
      char *end = find_string_literal_end(p);
      char *buf = calloc(end - start, sizeof(char));
      int len = 0;
#if 1
      while (p < end) {
  #if 0
        // ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã®å ´åˆ
        if (*p == '\\') {
          buf[len++] = '\\';
          buf[len++] = str_literal_escape_char(p + 1);
          p += 2;
        }
        else {
          buf[len++] = *p++;
        }
  #else
        buf[len++] = *p++;
  #endif
      }
#else
      memcpy(buf, start, end - start - 1);
#endif
      cur = new_token(TK_STR, cur, buf, buf + len - 1);
      p++; // ãƒ€ãƒ–ãƒ«ã‚¯ã‚ªãƒ¼ãƒˆã‚’èª­ã¿é£›ã°ã™
      continue;
    }
```


[02/23/2023 9:49 PM] mikiken#5554
`\a`ã¨ã‹`\e`ãŒå‹•ã‹ãªã„ã®ã¯ã€`.string`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ãŒã“ã‚Œã‚‰ã®ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã«å¯¾å¿œã—ã¦ã„ãªã„ã£ã½ã„


[02/23/2023 9:50 PM] mikiken#5554
http://web.mit.edu/gnu/doc/html/as_7.html#SEC120
> **.string "str"**
> Copy the characters in str to the object file. You may specify more than one string to copy, separated by commas. Unless otherwise specified for a particular machine, the assembler marks the end of each string with a 0 byte. You can use any of the escape sequences described in section __Strings__.


[02/23/2023 9:51 PM] mikiken#5554
Stringsã®sectionã‚’è¦‹ã¦ã¿ã‚‹ã¨ã€


[02/23/2023 9:55 PM] mikiken#5554
> **Strings**
> A string is written between double-quotes. It may contain double-quotes or null characters. The way to get special characters into a string is to escape these characters: precede them with a backslash `\` character. For example `\\` represents one backslash: the first `\` is an escape which tells *as* to interpret the second character literally as a backslash (which prevents *as* from recognizing the second `\` as an escape character). The complete list of escapes follows.


[02/23/2023 9:55 PM] mikiken#5554
> `\b`
> Mnemonic for backspace; for ASCII this is octal code 010.
> `\f`
> Mnemonic for FormFeed; for ASCII this is octal code 014.
> `\n`
> Mnemonic for newline; for ASCII this is octal code 012.
> `\r`
> Mnemonic for carriage-Return; for ASCII this is octal code 015.
> `\t`
> Mnemonic for horizontal Tab; for ASCII this is octal code 011.
> `\ digit digit digit`
> An octal character code. The numeric code is 3 octal digits. For compatibility with other Unix systems, 8 and 9 are accepted as digits: for example, `\008` has the value 010, and `\009` the value 011.
> `\x hex-digit hex-digit`
> A hex character code. The numeric code is 2 hexadecimal digits. Either upper or lower case x works.
> `\\`
> Represents one `\` character.
> `\"`
> Represents one `"` character. Needed in strings to represent this character, because an unescaped `"` would end the string.
> `\ anything-else`
> Any other character when escaped by `\` gives a warning, but assembles as if the `\` was not present. The idea is that if you used an escape sequence you clearly didn't want the literal interpretation of the following character. However *as* has no other interpretation, so *as* knows it is giving you the wrong code and warns you of the fact.
> Which characters are escapable, and what those escapes represent, varies widely among assemblers. The current set is what we think the BSD 4.2 assembler recognizes, and is a subset of what most C compilers recognize. If you are in doubt, do not use an escape sequence.


[02/23/2023 11:37 PM] mikiken#5554
gccã¯ä¸Šè¨˜ã«è¨˜è¼‰ã•ã‚Œã¦ã„ãªã„ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã®å ´åˆ(ä¾‹ãˆã°`\a`)ã€`\007`ã®ã‚ˆã†ã«8é€²ã‚³ãƒ¼ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’ä½¿ã£ã¦è¡¨ç¾ã—ã¦ã„ã‚‹


[02/24/2023 2:28 PM] mikiken#5554
https://note.com/ruiu/n/ncacaa6cf8d8f

{Embed}
https://note.com/ruiu/n/ncacaa6cf8d8f
ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã«ä»•è¾¼ã¾ã‚ŒãŸç´°å·¥ã¨ã‚·ã‚¹ãƒ†ãƒ ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®è©±ï½œRui Ueyamaï½œnote
ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã®ã‚½ãƒ¼ã‚¹ã«ã¯æ›¸ã„ã¦ã„ãªã„ã®ã«ãƒã‚¤ãƒŠãƒªã ã‘ã§ä»£ã€…ä¼ã‚ã£ã¦ã„ãæƒ…å ±ã¨ã„ã†ã®ãŒã‚ã£ã¦ã€ãã‚Œã¯ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã«å¤§ããé–¢ã‚ã£ã¦ã„ã‚‹ã€‚ã“ã“ã§ã¯ãã‚Œã«ã¤ã„ã¦æ›¸ã„ã¦ã¿ã‚ˆã†ã€‚  åƒ•ã¯8ccã¨ã„ã†Cã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã‚’ã‚¹ã‚¯ãƒ©ãƒƒãƒã‹ã‚‰æ›¸ã„ãŸã“ã¨ãŒã‚ã‚‹ã®ã ã‘ã©ã€8ccã«ã¯æ–‡å­—åˆ—ã‚’èª­ã‚€éƒ¨åˆ†ã§ã€"\"ã®å¾Œã«"n"ãŒããŸã‚‰"\n"ã¨ã„ã†æ–‡å­—ï¼ˆæ”¹è¡Œæ–‡å­—ï¼‰ã‚’èª­ã‚“ã ã“ã¨ã«ã™ã‚‹ã¨ã„ã†ç®‡æ‰€ãŒã‚ã‚‹ã€‚ã“ã‚Œã¯ã‚ˆãè€ƒãˆã¦ã¿ã‚Œã°è‡ªå·±è¨€åŠçš„ã«ãªã£ã¦ã„ã¦ã€ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã®ä¸­ã«ã€ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ãŒå®Ÿéš›ã«å¿…è¦ã¨ã™ã‚‹æ”¹è¡Œæ–‡å­—ã®ASCIIã‚³ãƒ¼ãƒ‰ã®æƒ…å ±ãŒå«ã¾ã‚Œã¦ã„ãªã„ã€‚ã—ã‹ã—ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã‚’ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã™ã‚‹ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã‹ã‚‰ãã®æƒ…å ±ãŒå—ã‘ç¶™ãŒã‚Œã‚‹ã®ã§ã€
https://images-ext-2.discordapp.net/external/NK6FFNgakmxwTYHxBOO9a2RmHEtJ3EfNQPEmh9cqMaY/%3Ffit%3Dbounds%26format%3Djpeg%26quality%3D85%26width%3D330/https/assets.st-note.com/production/uploads/images/903591/profile_3cbfe950fdd5a01d7eb0be427dc798a5.jpg


[02/24/2023 2:36 PM] mikiken#5554
ãã†ã„ãˆã°ã€`gen_data_section()`ã®ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãæ›ãˆã¦ãŸã¨ãã«ã€`printf`ã¨ã‹`putchar`ã®å‡ºåŠ›ãŒã™ãã«ã¯è¡¨ç¤ºã•ã‚Œãªã‹ã£ãŸãŒã€ã“ã‚Œã¯ä¸€æ—¦å‡ºåŠ›ãŒã‚¹ãƒˆãƒªãƒ¼ãƒ ã«ãƒãƒƒãƒ•ã‚¡ãƒªãƒ³ã‚°ã•ã‚Œã‚‹ã®ãŒåŸå› 
(å¿…è¦ãªå ´åˆã¯`fflush`é–¢æ•°ã‚’ç”¨ã„ã‚‹ã“ã¨ã§ã€å³åº§ã«ãƒãƒƒãƒ•ã‚¡ã‚’åãå‡ºã™ã“ã¨ãŒã§ãã‚‹)


[02/24/2023 4:18 PM] mikiken#5554
ã¨ã‚Šã‚ãˆãšã€æ–‡å­—åˆ—ãƒªãƒ†ãƒ©ãƒ«å†…ã®ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ãŒã¡ã‚ƒã‚“ã¨å‡ºåŠ›ã•ã‚Œã‚‹ã‚ˆã†ã«ãªã£ãŸ
https://github.com/mikiken/9cc/commit/613ade31af9bbad8bfef1d13cbc9dc0ae5f57593

{Embed}
https://github.com/mikiken/9cc/commit/613ade31af9bbad8bfef1d13cbc9dc0ae5f57593
Fix the code for putting escape sequences in `.string` directive Â· ...
https://images-ext-2.discordapp.net/external/CcUqLKPOeqrjzPatmGlB4wsNFjNhyuYTlp0B1CML45Q/https/opengraph.githubassets.com/fc83e972b7bed95451c7f825871af6dc81e97c9eab34860f1f08728bfb9ce538/mikiken/9cc/commit/613ade31af9bbad8bfef1d13cbc9dc0ae5f57593


[02/24/2023 4:20 PM] mikiken#5554
ã‹ãªã‚Šæ¨ªé“ã«é€¸ã‚ŒãŸã‘ã©ã€ãªã«ã‚’ã—ã¦ã„ãŸã‹ã¨ã„ã†ã¨ã€
```C
char str[] = "hoge";
```
ã¿ãŸã„ãªæ§‹æ–‡ã‚’æ›¸ã‘ã‚‹ã‚ˆã†ã«ã—ã‚ˆã†ã¨ã—ã¦ã„ãŸã¯ãš


[02/24/2023 4:23 PM] mikiken#5554
```C
char *str = "hoge";
```
ã¨ã¯é•ã£ã¦ã€ä¸Šè¨˜ã®æ§‹æ–‡ã¯ã¡ã‚ƒã‚“ã¨ã‚¹ã‚¿ãƒƒã‚¯é ˜åŸŸã«ç¢ºä¿ã•ã‚ŒãŸcharã®é…åˆ—ã¨ã—ã¦æ‰±ã‚ãªã„ã¨ã ã‚


[02/26/2023 4:11 PM] mikiken#5554
å®Ÿè£…ã—ãŸ
https://github.com/mikiken/9cc/commit/724a72c7e3d6c6f2f3718832c421713ddacc0973

{Embed}
https://github.com/mikiken/9cc/commit/724a72c7e3d6c6f2f3718832c421713ddacc0973
Implement initialization expressions for string literals Â· mikiken/...
https://images-ext-2.discordapp.net/external/RTIEk3phFR_Z2RRII_FN1xw9uUxNOgzElL15wFJBvww/https/opengraph.githubassets.com/adafd5b427d1b5cfbcee4ef39f7728d20e1909621d73265306de58b2f1a09ce3/mikiken/9cc/commit/724a72c7e3d6c6f2f3718832c421713ddacc0973


[02/26/2023 4:27 PM] mikiken#5554
~~ç¶šã„ã¦ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ã®åˆæœŸåŒ–å¼ã‚’å®Ÿè£…ã—ã¦ã„ã~~
**(è¿½è¨˜)ä¸€æ—¦ä¿ç•™**


[02/26/2023 10:36 PM] mikiken#5554
ã¨ã‚Šã‚ãˆãšæ–‡å­—åˆ—ãƒªãƒ†ãƒ©ãƒ«ã®åˆæœŸåŒ–å¼ã¯å¾Œå›ã—ã«ã—ã¦ã€ãŸã ã®ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ã®åˆæœŸåŒ–å¼ã¨ã‚°ãƒ­ãƒ¼ãƒãƒ«ã®é…åˆ—ã®åˆæœŸåŒ–å¼ã‚’å®Ÿè£…ã—ã¦ã„ã


[03/02/2023 7:15 PM] mikiken#5554
ãƒ­ãƒ¼ã‚«ãƒ«å¤‰æ•°ã®åˆæœŸåŒ–å¼ã¯ã€å˜ã«å®£è¨€ã®å¼ã¨ä»£å…¥ã®å¼ã«åˆ†è§£ã—ã¦ãƒ‘ãƒ¼ã‚¹ã™ã‚Œã°è‰¯ã„ã ã‘ã ã£ãŸã‘ã©ã€ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ã®å ´åˆã¯ãã†ã¯ã„ã‹ãªã„


[03/03/2023 11:47 AM] mikiken#5554
ä¾‹ãˆã°ã€ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«ã«
```C
int x = 3;
```
ã¨æ›¸ã„ãŸå ´åˆã€
```wasm
x:
        .long   3
```
ã¨ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—ãªã„ã¨ã„ã‘ãªã„


[03/03/2023 12:26 PM] mikiken#5554
ç¾çŠ¶ã€
`codegen.c`
```C
void gen_data_secton(Obj *gvar_list) {
  printf(".data\n");
  for (Obj *obj = gvar_list; obj->next != NULL; obj = obj->next) {
    // æ–‡å­—åˆ—ãƒªãƒ†ãƒ©ãƒ«ã®å ´åˆ
    if (obj->init_data)
      print_string_literal(obj->str_id, obj->init_data);
    // ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ã®å ´åˆ
    else {
      printf("%s:\n", obj->name);
      printf("  .zero %d\n", calc_gvar_size(obj->type));
    }
  }
  printf("\n");
}
```
ã¨ãªã£ã¦ã„ã‚‹ã®ã§ã€


[03/03/2023 12:29 PM] mikiken#5554
`Obj`ã«`init_expr`ã¿ãŸã„ãªãƒ¡ãƒ³ãƒã‚’è¿½åŠ ã™ã‚‹ã®ãŒè‰¯ã•ãã†
```C
typedef struct Obj Obj;

struct Obj {
  Obj *next;  // æ¬¡ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¾ãŸã¯NULL
  Type *type; // å‹
  int len;    // è­˜åˆ¥å­ã¾ãŸã¯æ–‡å­—åˆ—ãƒªãƒ†ãƒ©ãƒ«ã®æ–‡å­—æ•°

  // å¤‰æ•°
  char *name; // å¤‰æ•°ã®åå‰
  int offset; // RBPã‹ã‚‰ã®ã‚ªãƒ•ã‚»ãƒƒãƒˆ(ãƒ­ãƒ¼ã‚«ãƒ«å¤‰æ•°ã®ã¨ãã®ã¿ä½¿ç”¨)

  // æ–‡å­—åˆ—ãƒªãƒ†ãƒ©ãƒ«
  char *init_data;
  int str_id;
};
```


[03/03/2023 11:10 PM] mikiken#5554
ã¨æ€ã£ãŸã‘ã©ã€ã‚ã‚“ã©ãã•ãã†ãªã®ã§ã€ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ã®åˆæœŸåŒ–å¼ã¯ã€ä¸€æ—¦å¾Œå›ã—ã«ã—ã‚ˆã†ã‹ãª


[03/03/2023 11:11 PM] mikiken#5554
ä¾‹ãˆã°ã€
```C
int x = 3 + 2 * 4;
```
ã¿ãŸã„ãªå¼ã‚‚ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«ã«æ›¸ã‘ã‚‹ã¯ãšã ãŒã€ã“ã‚Œã‚’ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—ã‚ˆã†ã¨ã™ã‚‹ã¨ã€é™çš„è§£æã®æ™‚ç‚¹ã§å€¤ã‚’è¨ˆç®—ã—ã¦ãŠã‹ãªã„ã¨ã„ã‘ãªã„æ°—ãŒã™ã‚‹(?)


[03/03/2023 11:12 PM] mikiken#5554
ã¨ã‚Šã‚ãˆãšã€å˜ã«å®šæ•°ã‚’ä»£å…¥ã™ã‚‹å ´åˆã®ã¿æ›¸ã‘ã‚‹ã‚ˆã†ã«ã—ã¦ã‚‚ã„ã„ã‘ã©ã€ãã‚‚ãã‚‚ä»Šã®å®Ÿè£…ã§ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ã‚’0ä»¥å¤–ã§åˆæœŸåŒ–ã—ã¦ã‚‹ã¨ã“ã‚ã£ã¦ãã‚“ãªã«ãªã„ã¨æ€ã†ã‹ã‚‰ã€ã¨ã‚Šã‚ãˆãšå¾Œã«å›ãã†ã¨ã„ã†åˆ¤æ–­


[03/03/2023 11:15 PM] mikiken#5554
ç¾æ™‚ç‚¹ã§ã®`parse.c`ã‚’ä¿å­˜ã—ã¦ãŠã


[03/03/2023 11:15 PM] mikiken#5554


{Attachments}
https://cdn.discordapp.com/attachments/1003859454191751178/1081218367576358993/parse.c


[03/03/2023 11:16 PM] mikiken#5554
ã¨ã„ã†ã“ã¨ã§ã€æ¬¡ã«å®Ÿè£…ã—ãŸã„ã¨æ€ã£ã¦ãŸå¤šæ¬¡å…ƒé…åˆ—ã‚’å®Ÿè£…ã—ã¦ã„ã


[03/04/2023 1:36 AM] mikiken#5554
https://hsjoihs.hatenablog.com/entry/2018/12/17/235557#f-f5c5ed98

{Embed}
hsjoihs
https://hsjoihs.hatenablog.com/entry/2018/12/17/235557
C(ã®ã‚µãƒ–ã‚»ãƒƒãƒˆ)ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã‚’æ›¸ãä¸Šã§ãƒãƒã£ãŸç‚¹ï¼šé…åˆ—ç·¨ - hsjoihsâ€™s diary
åˆã‚ã« ã€Œé…åˆ—ç·¨ã€ã¨éŠ˜æ‰“ã£ã¦ã„ã¾ã™ãŒã€ç¶šç·¨ãŒæŠ•ç¨¿ã•ã‚Œã‚‹ä¿è¨¼ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ ãã†ãã† ã“ã®è¨˜äº‹ã¯è¨€èªå®Ÿè£… Advent Calendar 2018ã¨Cè¨€èª Advent Calendar 2018ã®17æ—¥ç›®ã®è¨˜äº‹ã§ã™ã€‚ æƒ³å®šã—ã¦ã„ã‚‹èª­è€…å±¤ ï¼ˆã©ã†ã„ã†èª­è€…å±¤ã‚’æƒ³å®šã—ã¦ã„ã‚‹ã‚“ã ã‚ã†ã€æ›¸ã„ã¦ã„ã¦è‡ªåˆ†ã§ã‚‚ã‚ˆãåˆ†ã‹ã‚‰ãªããªã£ãŸï¼‰ï¼ˆCã‚³ãƒ³ãƒ‘ã‚¤ãƒ©æ›¸ã„ã¦ã„ã¦ã€Œé…åˆ—ã®é…åˆ—ï¼ˆã„ã‚ã‚†ã‚‹äºŒæ¬¡å…ƒé…åˆ—ï¼‰ãŒãªã‚“ã‹ãƒã‚°ã‚‹ãªãã€ã¨ãªã£ãŸäººã®ãŸã‚ã®è¨˜äº‹ã‹ã‚‚ãªãï¼‰ï¼ˆã¨ã„ã†ã‹ã€å¤šåˆ†ãƒã‚°ã‚‰ã›ã¦ã„ãŸå½“æ™‚ã®è‡ªåˆ†ã¸ã®æ‰‹ç´™ï¼‰ æœ¬é¡Œã«å…¥ã‚ã† Cã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã‚’æ›¸ãä¸Šã§å¾®å¦™ã«ãƒãƒã£ãŸã€é…åˆ—ã¸ã®ãƒã‚¤ãƒ³ã‚¿ã®è©±ã€ãã‚Œã«ä»˜éšã—ã¦æ§‹é€ ä½“ã‚’å®Ÿè£…ã™ã‚‹éš›ã®è©±ã«ã¤ã„ã¦è»½â€¦
https://images-ext-2.discordapp.net/external/Iju3bue1DzyfaNefAfRRxt1Oi9lsFear8sWvDR0Ala4/https/ogimage.blog.st-hatena.com/10257846132626756034/10257846132686209724/1545058557


[03/04/2023 1:46 AM] mikiken#5554
ãŸã¶ã‚“**é…åˆ—å…¨ä½“ã¸ã®ãƒã‚¤ãƒ³ã‚¿**ã•ãˆå®Ÿè£…ã§ãã‚Œã°ã€å‰²ã¨ã™ãã«å®Ÿè£…ã§ããã†


[03/05/2023 12:36 AM] mikiken#5554
`int arr[3][5];`ã¨ã„ã†å®£è¨€ã«å¯¾ã—ã¦ã€`arr[2][4]`ã¯`*(*(arr+2)+4)`ã¨ã—ã¦ãƒ‘ãƒ¼ã‚¹ã™ã‚Œã°OK


[03/06/2023 12:51 PM] mikiken#5554
`parse_type()`ã¨`declaration()`ã§å‹ã®ãƒ‘ãƒ¼ã‚¹ã‚’(å®Ÿè³ª)2å›ã‚„ã£ã¦ã‚‹ã®ã€è¨­è¨ˆæ‚ªãã†


[03/06/2023 12:51 PM] mikiken#5554
è­˜åˆ¥å­ã ã‘ä¿å­˜ã—ã¨ã„ã¦ã€`parse_type()`ã§ãƒˆãƒ¼ã‚¯ãƒ³ã‚’èª­ã¿é€²ã‚ã¦ãŠã‘ã°ã‚ˆã•ãã†?


[03/06/2023 4:22 PM] mikiken#5554
ã¨ã‚Šã‚ãˆãšã€`parse_type()`ã‚’`parse_base_type()`ã¨`parse_variable_type()`ã«åˆ†å‰²ã—ã€å„é–¢æ•°ã®ä¸­ã§ãƒˆãƒ¼ã‚¯ãƒ³ã‚’èª­ã¿é€²ã‚ã‚‹ã‚ˆã†ã«ã—ãŸ


[03/06/2023 4:23 PM] mikiken#5554
`declaration()`ã®ä¸­ãŒã¾ã ç›´ã›ã¦ãªã„ã®ã§ã€ç›´ã™


[03/06/2023 10:06 PM] mikiken#5554
ä¸€æ—¦ãƒ¡ãƒ¢
```C
  // é…åˆ—ã®å ´åˆ
  if (dec_type->kind == TYPE_ARRAY) {
    while (dec_type->ptr_to) {
      // é…åˆ—ã®è¦ç´ æ•°ãŒæ˜ç¤ºã•ã‚Œã¦ã„ã‚‹å ´åˆ
      if (dec_type->array_size) {
        Node *node = new_lvar_definition(func, dec_type, ident);
        skip_token(tok, 4);
        // åˆæœŸåŒ–å¼ãŒã‚ã‚‹å ´åˆ
        if (consume(tok, TK_ASSIGN)) {
          // æ–‡å­—åˆ—ãƒªãƒ†ãƒ©ãƒ«ã®åˆæœŸåŒ–å¼ã®å ´åˆ
          if (consume_nostep(tok, TK_STR)) {
            node = init_str_literal_array(func, dec_type, tok, var_node(func, ident));
            next_token(tok);
          }
          else {
            expect(tok, TK_LEFT_BRACE);
            node = array_init(func, dec_type, tok, var_node(func, ident));
          }
        }
        return node;
      }
      // é…åˆ—ã®è¦ç´ æ•°ãŒæ˜ç¤ºã•ã‚Œã¦ã„ãªã„å ´åˆ
      else {
        skip_token(tok, 3);
        expect(tok, TK_ASSIGN); // é…åˆ—ã®è¦ç´ æ•°ãŒæ˜ç¤ºã•ã‚Œã¦ã„ãªã„å ´åˆã€åˆæœŸåŒ–å¼ãŒç¶šãã¯ãš
        Node *node;
        Node *array_node = new_node(ND_LVAR);
        // æ–‡å­—åˆ—ãƒªãƒ†ãƒ©ãƒ«ã®åˆæœŸåŒ–å¼ã®å ´åˆ
        if (consume_nostep(tok, TK_STR)) {
          node = init_str_literal_array(func, dec_type, tok, array_node);
          next_token(tok);
        }
        else {
          expect(tok, TK_LEFT_BRACE);
          node = array_init(func, dec_type, tok, array_node);
        }
        (void)new_lvar_definition(func, dec_type, ident);
        *array_node = *var_node(func, ident);
        return node;
      }
    }
  }
```


[03/06/2023 10:14 PM] mikiken#5554
åˆæœŸåŒ–å¼ãŒå­˜åœ¨ã™ã‚‹ã¨ãã«é…åˆ—å®£è¨€ã®è¦ç´ æ•°ã‚’çœç•¥ã§ãã‚‹è¨˜æ³•ã¯ã€é›£ã—ãã†ãªã®ã§ã€ä¸€æ—¦æ¶ˆã—ã¦ã‹ã‚‰å¾Œã§å¾©æ´»ã•ã›ã‚‹ã‹


[03/07/2023 1:08 AM] mikiken#5554
`semantic_analysis.c`ã§ã€
> ä¸æ­£ãªåŠ ç®—ã‚’è¡Œã†ã“ã¨ã¯ã§ãã¾ã›ã‚“
ã¨ã„ã†ã‚¨ãƒ©ãƒ¼ãŒå‡ºãŸã®ã§ã€åŸå› ã‚’èª¿ã¹ã‚‹


[03/07/2023 1:09 AM] mikiken#5554
ã“ã“ã§ã€é…åˆ—å…¨ä½“ã¸ã®ãƒã‚¤ãƒ³ã‚¿ã‚’å®Ÿè£…ã™ã‚‹å¿…è¦ãŒå‡ºã¦ãã‚‹ã®ã ã¨æ€ã‚ã‚Œã‚‹


[03/07/2023 11:12 PM] mikiken#5554


{Attachments}
https://cdn.discordapp.com/attachments/1003859454191751178/1082667033063325847/P_20230307_231121.jpg


[03/07/2023 11:15 PM] mikiken#5554
**`int arr[2][3]`ãŒ`int [3]`ã®è¦ç´ æ•°2ã®é…åˆ—å‹ã§ã‚ã‚‹**ã“ã¨ã«æ³¨æ„ã™ã‚‹å¿…è¦ãŒã‚ã‚‹
(ç›´æ„Ÿã«åã™ã‚‹)


[03/07/2023 11:27 PM] mikiken#5554
å¤šæ¬¡å…ƒé…åˆ—ã®ãƒ‘ãƒ¼ã‚¹ã®ä»•æ–¹ã‚’ãƒŸã‚¹ã£ã¦ãŸã®ã§ã€ç›´ã™
é †æ–¹å‘ã«ä¼¸ã³ã‚‹Linked Listã¨ã—ã¦å®Ÿè£…ã™ã‚Œã°OKãªã¯ãš


[03/07/2023 11:48 PM] mikiken#5554
ç›´ã›ãŸ


[03/08/2023 12:59 AM] mikiken#5554
ä»Šã¾ã§ã¯ã€ä¸€æ¬¡å…ƒé…åˆ—ã§ã‚ã‚‹ã“ã¨ã‚’(æš—é»™ã«)ä»®å®šã—ã¦ãŸã®ã§ã€
```C
    case ND_ADD: {
      Node *lhs = add_type_to_node(lvar_list, node->lhs);
      Node *rhs = add_type_to_node(lvar_list, node->rhs);
      // å·¦è¾ºãŒé…åˆ—ã®å ´åˆã€ãƒã‚¤ãƒ³ã‚¿ã«ã‚­ãƒ£ã‚¹ãƒˆã™ã‚‹
      if (is_array_type_node(lhs))
        lhs = cast_array_to_pointer(lhs);
      // å³è¾ºãŒé…åˆ—ã®å ´åˆã€ãƒã‚¤ãƒ³ã‚¿ã«ã‚­ãƒ£ã‚¹ãƒˆã™ã‚‹
      if (is_array_type_node(rhs))
        rhs = cast_array_to_pointer(rhs);
      // ãƒã‚¤ãƒ³ã‚¿åŒå£«ã®åŠ ç®—ã¯ç¦æ­¢ã•ã‚Œã¦ã„ã‚‹ã®ã§ã‚¨ãƒ©ãƒ¼ã«ã™ã‚‹
      if (lhs->type->kind == TYPE_PTR && rhs->type->kind == TYPE_PTR)
        error("ãƒã‚¤ãƒ³ã‚¿åŒå£«ã‚’åŠ ç®—ã™ã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“");
      // å·¦è¾ºãŒintå‹ã€å³è¾ºãŒãƒã‚¤ãƒ³ã‚¿ã®å ´åˆã¯ä¸¡è¾ºã‚’å…¥ã‚Œæ›¿ãˆã‚‹
      if (lhs->type->kind == TYPE_INT && rhs->type->kind == TYPE_PTR) {
        Node *original_lhs = lhs;
        lhs = rhs;
        rhs = original_lhs;
      }
      // å·¦è¾ºãŒãƒã‚¤ãƒ³ã‚¿å‹ã€å³è¾ºãŒintå‹ã®å ´åˆ
      if (lhs->type->kind == TYPE_PTR && rhs->type->kind == TYPE_INT) {
        Node *size = new_size_node(lhs->type->ptr_to->kind);
        Node *mul_scaling = new_typed_binary(new_typed_node(new_type(TYPE_INT), new_node(ND_MUL)), size, rhs);
        return new_typed_binary(new_typed_node(lhs->type, node), lhs, mul_scaling);
      }
      // ä¸¡è¾ºãŒç®—è¡“å‹ã®å ´åˆ
      else if (is_arithmeric_type(lhs->type->kind) && is_arithmeric_type(rhs->type->kind)) {
        fix_rhs_type(lhs, rhs);
        return new_typed_binary(new_typed_node(new_type(TYPE_INT), node), lhs, rhs);
      }
      else {
        error("ä¸æ­£ãªåŠ ç®—ã‚’è¡Œã†ã“ã¨ã¯ã§ãã¾ã›ã‚“");
      }
    }
```


[03/08/2023 1:00 AM] mikiken#5554
ã®ä¸­ã§ã€
```C
      // å·¦è¾ºãŒãƒã‚¤ãƒ³ã‚¿å‹ã€å³è¾ºãŒintå‹ã®å ´åˆ
      if (lhs->type->kind == TYPE_PTR && rhs->type->kind == TYPE_INT) {
        Node *size = new_size_node(lhs->type->ptr_to->kind);
        Node *mul_scaling = new_typed_binary(new_typed_node(new_type(TYPE_INT), new_node(ND_MUL)), size, rhs);
        return new_typed_binary(new_typed_node(lhs->type, node), lhs, mul_scaling);
      }
```
ã®ã‚ˆã†ã«ã‚­ãƒ£ã‚¹ãƒˆã™ã‚‹ã“ã¨ã§ã€ä¸Šæ‰‹ãã„ã£ã¦ã„ãŸ


[03/08/2023 1:01 AM] mikiken#5554
ã—ã‹ã—ã€å¤šæ¬¡å…ƒé…åˆ—ã®å ´åˆã¯ã€`lhs->type->ptr_to`ã«`int`ã®ã‚ˆã†ãªåŸºæœ¬å‹ãŒæ¥ã‚‹ã¨ã¯é™ã‚‰ãªã„
å®Ÿéš›ã€äºŒæ¬¡å…ƒé…åˆ—ã®å ´åˆã¯ã€`lhs->type->ptr_to`ã«`TYPE_ARRAY`ãŒæ¥ã¦ã„ã‚‹


[03/08/2023 1:03 AM] mikiken#5554
`add_type_to_node`ã‚’å†å¸°çš„ã«å‘¼ã³å‡ºã™éš›ã«ã€å‹æƒ…å ±ã‚‚ã€1æ®µæ·±ã„ã‚‚ã®ã‚’æ¸¡ã™å¿…è¦ãŒã‚ã‚‹(?)


[03/08/2023 1:08 AM] mikiken#5554
è©±ãŒæˆ»ã‚‹ã‘ã©ã€ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ã®åˆæœŸåŒ–å¼ã€å®šæ•°ã‚’ãƒ™ã‚¿æ›¸ãã™ã‚‹è¨˜æ³•ã ã‘ã‚µãƒãƒ¼ãƒˆã—ã¦ãŠãã®ã¯ã‚ã‚Šã‹ã‚‚ã—ã‚Œãªã„


[03/08/2023 11:37 AM] mikiken#5554
ã‚„ã£ã¦ã„ã


[03/08/2023 11:40 AM] mikiken#5554
`int arr[2][3]`ã¨ã„ã†å®£è¨€ãŒã‚ã£ãŸã¨ã—ã¦ã€
> 1å›ç›®ã®é–“æ¥å‚ç…§ã§ã¯ã€`ND_DEREF`ã®å‹ã¯`int [3]`ã§ã‚ã‚‹ã¹ãã§ã‚ã‚Šã€
> 2å›ç›®ã®é–“æ¥å‚ç…§ã§ã¯ã€`ND_DEREF`ã®å‹ã¯`int`ã§ã‚ã‚‹ã¹ãã§ã‚ã‚‹
ã£ã¦ã“ã¨ã«ãªã‚‹ã¯ãš


[03/08/2023 6:18 PM] mikiken#5554
https://natsutan.hatenablog.com/entry/2022/11/10/100813

{Embed}
natsutan
https://natsutan.hatenablog.com/entry/2022/11/10/100813
ä½ãƒ¬ã‚¤ãƒ¤ã‚’çŸ¥ã‚ŠãŸã„äººã®ãŸã‚ã®Cã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ä½œæˆå…¥é–€ã®å¤šæ¬¡å…ƒé…åˆ— - ã±ãŸã¸ã­
ä½ãƒ¬ã‚¤ãƒ¤ã‚’çŸ¥ã‚ŠãŸã„äººã®ãŸã‚ã®Cã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ä½œæˆå…¥é–€ã‚’ã€Rustã§ã‚³ãƒ„ã‚³ãƒ„ã¨ã‚„ã£ã¦ã„ã‚‹ã€‚ www.sigbus.info ä»Šã¾ã§è‹¦åŠ´ã—ãªãŒã‚‰ã‚‚githubã®ã‚½ãƒ¼ã‚¹ã‚’è¦‹ãªãŒã‚‰ã¾ã£ã™ãã«æ¥ã‚ŒãŸãŒã€äºŒæ¬¡å…ƒé…åˆ—ã®æ‰€ã§èº“ã„ãŸã®ã§æ•´ç†ã—ã¦ã¿ãŸã€‚ å‹•ã‹ã—ãŸã„ã‚½ãƒ¼ã‚¹ ã¾ã ã“ã“ã¾ã§ã¯å‹•ã‹ãªã„ã‘ã©ã€ã‚„ã‚ŠãŸã„ã“ã¨ã¯ã“ã®Cã‚½ãƒ¼ã‚¹ã®æ¼”ç®—éƒ¨åˆ†ã‚’å‹•ã‹ã™äº‹ã€‚äºŒæ¬¡å…ƒé…åˆ—ã®å®£è¨€ã¨ã€ãƒã‚¤ãƒ³ã‚¿ãƒ¼ã¸ã®å¤‰æ›ã€ãƒ‡ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ã€‚ æµçŸ³ã«Cã®å‹•ããŒåˆ†ã‹ã‚‰ãªã„ã¨è¨€ã†ã“ã¨ã¯ãªã„ãŒã€ã¡ã‚ƒã‚“ã¨å‹•ãã‚¢ã‚»ãƒ³ãƒ–ãƒ©ã‚’è‡ªåŠ›ã§å‡ºåŠ›ã™ã‚‹ã®ã«ã¯é›£ã—ã„ã€‚ #include  int main() { int x [2][3]; int *y = x; iâ€¦
https://images-ext-2.discordapp.net/external/CP7WmgjWy-Evcz1cAMmsnE4JQBByod4Iwdi3NWaRkyA/https/cdn-ak.f.st-hatena.com/images/fotolife/n/natsutan/20221110/20221110002823.png


[03/08/2023 6:28 PM] mikiken#5554
`int x[2][3];`ã¨ã„ã†å®£è¨€ã«å¯¾ã—ã¦ã€`int (*x_ptr)[3] = &x[2]`ã¿ãŸã„ãªã‚³ãƒ¼ãƒ‰ã‚‚å‹•ã‹ãªã„ã¨ã„ã‘ãªã„ã¯ãš(è¦æ¤œè¨¼)


[03/08/2023 6:37 PM] mikiken#5554
ã¨ã‚Šã‚ãˆãšã€`add_type_to_node`ã®`ND_DEREF`ã§`lhs`ã®å‹ã‚’è¦‹ã¦ã€ãã®å‹ãŒé…åˆ—å‹ã§ã‚ã‚‹å ´åˆã¯ã€`ptr_to`ã«å…¥ã£ã¦ã„ã‚‹å‹æƒ…å ±ã‚’ä¸ãˆãŸä¸Šã§ã€`add_type_to_node`ã‚’å†åº¦å‘¼ã³å‡ºã›ã°OKãã†?


[03/11/2023 9:39 AM] mikiken#5554
**æ•°æ—¥çµŒé**


[03/11/2023 9:40 AM] mikiken#5554
ãã‚‚ãã‚‚ã€`add_type_to_node`ãŒãƒ‡ã‚«ã™ãã‚‹èª¬ã¯ã‚ã‚‹ãª


[03/11/2023 9:43 AM] mikiken#5554
ã“ã®é–¢æ•°ã¯ã€ãŸã æ©Ÿæ¢°çš„ã«å‹ã‚’ã¤ã‘ã‚‹ã ã‘ã«ã—ã¦ã€ãã®ä¸Šã§ã€å¾Œã‹ã‚‰å‹ã‚’ä¿®æ­£ã—ãŸã‚Šã€ãƒã‚¤ãƒ³ã‚¿æ¼”ç®—ç”¨ã«nodeã‚’è¿½åŠ ã—ãŸæ–¹ãŒè¦‹é€šã—è‰¯ã•ãã†


[03/11/2023 10:10 AM] mikiken#5554
```C
// ND_DEREFã§é–“æ¥å‚ç…§ã‚’è¡Œã£ãŸå ´åˆã€ãã®nodeã®ä»¥ä¸‹ã®å‹ã¯node->type->ptr_toã¨ãªã‚‹ã®ã§ã€å‹ã‚’ä»˜ã‘ç›´ã™
Node *fix_node_type_to_ptr_to(Node *node, Type *node_type) {
  switch (node->kind) {
    case ND_DEREF:
      node->type = node_type->ptr_to;
      return node;
    default:
      return node;
  }
}
```


[03/12/2023 1:00 AM] mikiken#5554
ãƒ†ãƒ³ãƒ—ãƒ¬ã‚’æ›¸ã„ãŸ
```C
Node *add_type_to_node(Node *node) {
  switch (node->kind) {
    case ND_STMT:
      return;
    case ND_EXPR:
      return;
    case ND_COMMA:
      return;
    case ND_ADD:
      return;
    case ND_SUB:
      return;
    case ND_MUL:
      return;
    case ND_DIV:
      return;
    case ND_MOD:
      return;
    case ND_EQ:
      return;
    case ND_NE:
      return;
    case ND_LT:
      return;
    case ND_LE:
      return;
    case ND_NOT:
      return;
    case ND_AND:
      return;
    case ND_OR:
      return;
    case ND_COND:
      return;
    case ND_ASSIGN:
      return;
    case ND_NUM:
      return;
    case ND_STR:
      return;
    case ND_LVARDEF:
      return;
    case ND_LVAR:
      return;
    case ND_GVAR:
      return;
    case ND_RETURN:
      return;
    case ND_IF:
      return;
    case ND_FOR:
      return;
    case ND_FUNCALL:
      return;
    case ND_ADDR:
      return;
    case ND_DEREF:
      return;
    case ND_SIZEOF:
      return;
  }
}
```


[03/12/2023 9:46 PM] mikiken#5554
(ä½œã‚Šç›´ã—ä¸­ã®)`add_type_to_node`ã«`ND_GVAR`ãŒã‚ã‚‹ãŒã€ã“ã‚Œã¯ã‚ãã¾ã§é–¢æ•°ã®ã‚¹ã‚³ãƒ¼ãƒ—ã®ä¸­ã§ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ã‚’èª­ã‚“ã å ´åˆã§ã‚ã£ã¦ã€ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«ã«ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ã«å®£è¨€ã‚’æ›¸ã„ãŸå ´åˆã§ã¯ãªã„


[03/12/2023 9:46 PM] mikiken#5554
(ãã‚‚ãã‚‚ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ã®åˆæœŸåŒ–å¼ã‚’å®Ÿè£…ã—ã¦ã„ãªã„ä»¥ä¸Šã€ãã‚Œã¯ãã†)


[03/17/2023 4:37 PM] mikiken#5554
**ã•ã‚‰ã«æ•°æ—¥çµŒé**


[03/17/2023 4:38 PM] mikiken#5554
ã¨ã‚Šã‚ãˆãšã€`add_type_to_node`ã§ã¯æ©Ÿæ¢°çš„ã«å‹ã‚’ä»˜ã‘ã‚‹ã ã‘ã«ã—ãŸ


[03/17/2023 4:39 PM] mikiken#5554
é…åˆ—ã‚’ãã®å…ˆé ­è¦ç´ ã¸ã®ãƒã‚¤ãƒ³ã‚¿ã«ã‚­ãƒ£ã‚¹ãƒˆã™ã‚‹å‡¦ç†ã‚„ã€ãƒã‚¤ãƒ³ã‚¿ã®åŠ ç®—æ¸›ç®—ã§ã€ã‚ªãƒ•ã‚»ãƒƒãƒˆã‚’`sizeof(lhs->type->ptr_to)`å€ã™ã‚‹å‡¦ç†ã¯ã€åˆ¥ã®é–¢æ•°ã§è¡Œã†ã“ã¨ã«ã—ãŸ


[03/17/2023 4:41 PM] mikiken#5554
ãªã‚“ã‹ã€æ”¹ã‚ã¦æ„å‘³è§£æã®å‡¦ç†ã‚’è¦‹è¿”ã™ã¨ã€å‹ã®æ‰±ã„æ–¹åˆã£ã¦ã‚‹?ã£ã¦æ€ã†ç®‡æ‰€ãŒã‚ã‚‹ã‘ã©ã€ã¨ã‚Šã‚ãˆãšæ°—ã«ã›ãšã«åˆ†å‰²ã—ã¦ã„ã


[03/22/2023 4:45 PM] mikiken#5554
ã¨ã‚Šã‚ãˆãšé–¢æ•°ã‚’åˆ†å‰²ã—ãŸãŒã€`semantic_analysis() : ä»£å…¥å¼ã®ä¸¡è¾ºã®å‹ãŒç•°ãªã‚Šã¾ã™`ãŒå‡ºã‚‹ãª


[03/22/2023 4:47 PM] mikiken#5554
ã©ã“ã§ã‚¨ãƒ©ãƒ¼ãŒå‡ºã¦ã‚‹ã‹ã¨ã„ã†ã¨ã€`test/array.c`ã®`array_test1`ã®ä»£å…¥å¼`*p=1`ã®éƒ¨åˆ†


[03/22/2023 4:49 PM] mikiken#5554
```C
int array_test1() {
  int a[2];
  int *p;
  p = a;
  *p = 1;
  *(p + 1) = 2;
  return *p + *(p + 1);
}
```


[03/22/2023 4:51 PM] mikiken#5554
`ND_DEREF`è‡ªä½“ã®å‹ã¯ã€`lhs->type->ptr_to`ã«ã—ãªã„ã¨ã„ã‘ãªã„ã®ã«ã€ãã†ãªã£ã¦ãªã‹ã£ãŸã®ã§ä¿®æ­£ã—ãŸ


[03/22/2023 5:23 PM] mikiken#5554
ãã‚Œã¯ãã†ã¨ã—ã¦ã€å¤§é‡ã®`Segmentation fault`ã¨`semantic_analysis() : ä»£å…¥å¼ã®ä¸¡è¾ºã®å‹ãŒç•°ãªã‚Šã¾ã™`ãŒå‡ºã¦ã„ã‚‹ã®ãŒæ°—ã«ãªã‚‹


[03/22/2023 5:24 PM] mikiken#5554
`arith.c`ã§ã™ã‚‰ã‚»ã‚°ãƒ•ã‚©ã—ã¦ã‚‹ã®ã§åŸå› ã‚’èª¿æŸ»ã™ã‚‹


[03/22/2023 5:29 PM] mikiken#5554
`codegen.c`ã§é–¢æ•°å‘¼ã³å‡ºã—ã®å¼•æ•°ã®å‹ã‚’å‚ç…§ã—ã‚ˆã†ã¨ã—ãŸã¨ã“ã‚ã€`ND_FUNCALL`ã®`body->type`ã«å‹æƒ…å ±ãŒå…¥ã£ã¦ãŠã‚‰ãšã‚¨ãƒ©ãƒ¼ã«ãªã£ã¦ã„ã‚‹ã‚‰ã—ã„


[03/22/2023 5:32 PM] mikiken#5554
`semantic_analysis()`ã‚’ç¢ºèªã—ãŸã¨ã“ã‚ã€æ™®é€šã«`case ND_FUNCALL:`ã®å®Ÿè£…å¿˜ã‚Œã¦ãŸã‚ğŸ˜‡


[03/22/2023 5:52 PM] mikiken#5554
å®Ÿè£…ã—ãŸ


[03/22/2023 6:06 PM] mikiken#5554
`arith.c`ã‚’9ccã§ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã™ã‚‹ã¨ã€`  assert(21, 5 + 20 - 4, "5 + 20 - 4");`ã®ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã§ã‚³ã‚±ã¦ã‚‹


[03/22/2023 6:07 PM] mikiken#5554
ãã‚‚ãã‚‚`ND_NUM`ã«å‹æƒ…å ±ãŒå…¥ã£ã¦ã„ãªã„ã£ã½ã„


[03/23/2023 10:42 PM] mikiken#5554
`add_type_to_node`ã¨`semantic_analysis`ã§ã€foræ–‡ã§`arg->body`ã«å¯¾ã—ã¦å‡¦ç†ã‚’è¡Œã†ã¹ãã¨ã“ã‚ãŒ`arg`ã«å¯¾ã—ã¦å‡¦ç†ã‚’è¡Œã£ã¦ãŸã®ãŒåŸå› 


[03/23/2023 10:43 PM] mikiken#5554
ã“ã‚Œã§ã€`arith.c`ã®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã¯é€šã‚‹ã‚ˆã†ã«ãªã£ãŸ


[03/23/2023 10:43 PM] mikiken#5554
æ¬¡ã«ã€`array.c`ã®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚’è©¦ã¿ã‚‹ã¨ã€ã‚„ã¯ã‚Šã‚»ã‚°ãƒ•ã‚©


[03/23/2023 10:47 PM] mikiken#5554
ã‚„ã¯ã‚ŠåŒã˜ã¨ã“ã‚ã§ã‚»ã‚°ãƒ•ã‚©ã—ã¦ã‚‹ãª
https://discord.com/channels/1002995356033896448/1003859454191751178/1088006142648660018


[03/23/2023 10:49 PM] mikiken#5554
ã¨ã‚Šã‚ãˆãšã€ä»£å…¥å¼ã«å‹æƒ…å ±ãŒå…¥ã£ã¦ã„ãªã„ã“ã¨ãŒåˆ†ã‹ã‚‹


[03/23/2023 10:53 PM] mikiken#5554
ç¢ºã‹ã«`semantic_analysis()`ã®`ND_ASSIGN`ã®ã¨ã“ã‚ã‚’è¦‹ã‚‹ã¨ã€nodeè‡ªä½“ã®å‹ã‚’æŒ‡å®šã—å¿˜ã‚Œã¦ã‚‹ãª


[03/24/2023 12:00 PM] mikiken#5554
å·¦è¾ºã®å‹ã«åˆã‚ã›ã‚‹ã‚ˆã†ã«ã—ãŸ


[03/24/2023 12:25 PM] mikiken#5554
ãªã‚“ã‹`codegen.c`ã§ãƒ¡ãƒ¢ãƒªä¸Šã®å€¤ã‚’ãƒ¬ã‚¸ã‚¹ã‚¿ã«ã‚»ãƒƒãƒˆã—ã‚ˆã†ã¨ã—ãŸã¨ãã«é…åˆ—å‹ãŒç™»å ´ã—ã¦ã‚¨ãƒ©ãƒ¼ã«ãªã£ã¦ã‚‹


[03/24/2023 12:25 PM] mikiken#5554
ã©ã®ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã§ã‚³ã‚±ã¦ã‚‹ã‚“ã ã‚


[03/24/2023 3:38 PM] mikiken#5554
æ§‹æ–‡æœ¨ã¯ã“ã‚“ãªæ„Ÿã˜


[03/24/2023 3:38 PM] mikiken#5554


{Attachments}
https://cdn.discordapp.com/attachments/1003859454191751178/1088713367486734367/P_20230324_153750.jpg


[03/24/2023 4:03 PM] mikiken#5554
~~è©²å½“ã™ã‚‹ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ç„¡ãã­?~~
(è¿½è¨˜) callstackã‚’ç¢ºèªã—ãŸã‚‰`array_test13()`ã§ã‚³ã‚±ã¦ã‚‹ã“ã¨ãŒåˆ¤æ˜


[03/24/2023 4:06 PM] mikiken#5554
`parse.c`ã¯ç‰¹ã«è§¦ã£ã¦ãªã„ã‹ã‚‰ã€æ„å‘³è§£æã®ã¨ã“ã‚ã§æ§‹æ–‡æœ¨ã‚’æ§‹ç¯‰ã™ã‚‹ã®ã‚’ãƒŸã‚¹ã£ã¦ãã†


[03/26/2023 4:12 PM] mikiken#5554
ç¾æ™‚ç‚¹ã§
```
arith.c
array.c
control_statement.c
function.c
string.c
test.c
variable.c
```
ã¯ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«å¯èƒ½


[03/26/2023 4:12 PM] mikiken#5554
ä¸€æ–¹ã§ã€`pointer.c`ã¯ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹


[03/26/2023 4:38 PM] mikiken#5554
VSCodeã®gdbæ‹¡å¼µ(?)ã€ã‚ã£ã¡ã‚ƒä¾¿åˆ©

{Attachments}
https://cdn.discordapp.com/attachments/1003859454191751178/1089453250484371526/image.png


[03/26/2023 4:39 PM] mikiken#5554
```C
int array_test13() {
  int a[5] = {1, 2, 3, 4, 5};
  int sum = 0;
  for (int i = 0; i < 5; i++)
    sum += a[i];
  return sum;
}
```


[03/26/2023 4:42 PM] mikiken#5554
ã“ã®é–¢æ•°ã®`sum += a[i]`ã®ã¨ã“ã‚ã§å‹ã®ä¸ä¸€è‡´ãŒèµ·ãã¦ã‚‹


[03/26/2023 4:46 PM] mikiken#5554
å³è¾ºã®é…åˆ—`a`ãŒãƒã‚¤ãƒ³ã‚¿ã«ã‚­ãƒ£ã‚¹ãƒˆã•ã‚Œã¦ãªã„ã®ãŒåŸå› ã£ã½ã„


[03/26/2023 4:55 PM] mikiken#5554
`semantic_analysis()`ã§`ND_FOR`ã®`node->then`ã®æ§‹æ–‡æœ¨ã®æ„å‘³è§£æã‚’ã—å¿˜ã‚Œã¦ã‚‹ã®ãŒåŸå› 


[03/26/2023 5:01 PM] mikiken#5554
```C
    case ND_FOR:
      if (node->init)
        semantic_analysis(node->init);
      if (node->cond)
        semantic_analysis(node->cond);
      // foræ–‡ã®ä¸­èº«ã®å‡¦ç†
      semantic_analysis(node->then);
      if (node->inc)
        semantic_analysis(node->inc);
      // nodeè‡ªä½“ã®å‹ã¯NULLã®ã¯ãš
      if (node->type->kind == TYPE_NULL)
        return;
      else
        error("semantic_analysis() : ifæ–‡ã®æ„å‘³è§£æã‚’è¡Œã†ã“ã¨ãŒã§ãã¾ã›ã‚“ã§ã—ãŸ");
```


[03/26/2023 5:01 PM] mikiken#5554
çœŸã‚“ä¸­ã«1è¡Œè¿½åŠ ã—ãŸã‚‰`array.c`ã®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ãŒé€šã‚‹ã‚ˆã†ã«ãªã£ãŸ


[03/26/2023 5:05 PM] mikiken#5554
ã‚ã¨`pointer.c`ã‚’é€šã›ã°ã€ç§»æ¤å®Œäº†ã—ãã†


[03/26/2023 5:06 PM] mikiken#5554
`pointer.c`ã®`pointer_test12()`ã§ã‚³ã‚±ã¦ã‚‹


[03/26/2023 5:32 PM] mikiken#5554
```C
int pointer_test12() {
  int a[2];
  int k;
  k = &a[1] - &a[0];
  return k;
}
```


[03/26/2023 6:04 PM] mikiken#5554
`ND_SUB`ã§ãƒã‚¤ãƒ³ã‚¿åŒå£«ã®å¼•ãç®—ã‚’ã„ã„æ„Ÿã˜ã«æ„å‘³è§£æã™ã‚‹ã¨ã“ã‚ã®ã‚³ãƒ¼ãƒ‰
```C
      // ä¸¡è¾ºãŒãƒã‚¤ãƒ³ã‚¿å‹ã®å ´åˆ
      else if (is_ptr_type(node->lhs->type) && is_ptr_type(node->rhs->type)) {
        if (node->lhs->type->ptr_to->kind != node->rhs->type->ptr_to->kind)
          error("semantic_analysis() : ç•°ãªã‚‹å‹ã¸ã®ãƒã‚¤ãƒ³ã‚¿åŒå£«ã§æ¸›ç®—ã‚’è¡Œã†ã“ã¨ã¯ã§ãã¾ã›ã‚“");
        Node *size = new_size_node(node->lhs->type->ptr_to);
        Node *diff_addr = new_typed_binary(new_typed_node(node->lhs->type, new_node(ND_SUB)), node->lhs, node->rhs);
        *node = *new_typed_binary(new_typed_node(new_type(TYPE_INT), new_node(ND_DIV)), diff_addr, size);
        return;
      }
```


[03/26/2023 6:04 PM] mikiken#5554
`node = new_typed_binary(~);`ã¨ãªã£ã¦ã„ãŸãŒã€ã“ã‚Œã§ã¯`ND_ASSIGN`ã®`node->rhs`ã®å‚ç…§å…ˆã¯å¤ã„æ§‹æ–‡æœ¨ã®ã¾ã¾ã«ãªã£ã¦ã—ã¾ã†ã€‚ãã“ã§ã€`*node = *new_typed_binary(~);`ã¨ã—ã¦ã€`Node *node`ã®å‚ç…§å…ˆè‡ªä½“ã‚’æ–°ã—ã„æ§‹æ–‡æœ¨ã«æ›¸ãæ›ãˆã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚


[03/28/2023 12:49 PM] mikiken#5554
ã“ã‚Œã§ã€`pointer.c`ã®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚‚é€šã‚‹ã‚ˆã†ã«ãªã£ãŸ


[03/28/2023 12:50 PM] mikiken#5554
`make test`ã™ã‚‹ã¨ã€`string.c`ã§ã‚¨ãƒ©ãƒ¼ãŒå‡ºã‚‹ãª


[03/28/2023 12:51 PM] mikiken#5554
```
[FAIL] {char x[3]; x[0] = -1; x[1] = 2; int y; y = 4; return x[0] + y;} => 3 expected, but got -253
```


[03/28/2023 12:58 PM] mikiken#5554
gdbã§`char_type_test1()`ã‹ã‚‰returnã—ãŸç›´å¾Œã®raxã®å€¤ã‚’è¦³å¯Ÿã™ã‚‹ã¨ä½•ã‹åˆ†ã‹ã‚Šãã†


[03/28/2023 8:57 PM] mikiken#5554
gdbã§èª¿ã¹ãŸæ„Ÿã˜ã“ã‚“ãªæ„Ÿã˜ã£ã½ã„

{Attachments}
https://cdn.discordapp.com/attachments/1003859454191751178/1090243350633914368/message.txt


[03/31/2023 4:07 PM] mikiken#5554
ãŸã¶ã‚“å…ƒã€…raxã®ãƒ“ãƒƒãƒˆãŒã™ã¹ã¦ç«‹ã£ã¦ã‚‹çŠ¶æ…‹`0xffffffff`ã‹ã‚‰ã€raxã®ä¸‹ä½1byteã®ã¿æ›¸ãæ›ãˆã‚‰ã‚ŒãŸçµæœã€`0xffffff03`ã¨ã„ã†ãƒ“ãƒƒãƒˆãƒ‘ã‚¿ãƒ¼ãƒ³ã«ãªã£ãŸ


[03/31/2023 4:09 PM] mikiken#5554
ãªã®ã§`rax`ã®ãƒ“ãƒƒãƒˆãƒ‘ã‚¿ãƒ¼ãƒ³ã®ä¸‹ä½1byteã®ã¿ã‚’èª­ã‚€ã¨ã€ã¡ã‚ƒã‚“ã¨`3`ã¨ã„ã†å€¤ã«ãªã‚‹


[03/31/2023 4:10 PM] mikiken#5554
ä¸€æ–¹ã§ã€`rax`ã®ãƒ“ãƒƒãƒˆãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’`(signed) int`ã¨ã—ã¦èª­ã‚€ã¨ã€`0xff03`ã¨ãªã‚‹ã®ã§ã€`-253`ã¨ã„ã†å€¤ã«ãªã‚‹


[03/31/2023 4:10 PM] mikiken#5554
ã£ã¦ã“ã¨ã ã¨æ€ã†


[03/31/2023 5:23 PM] mikiken#5554
ã¨ã‚Šã‚ãˆãšã€å¤ã„å®Ÿè£…ãŒåãã‚¢ã‚»ãƒ³ãƒ–ãƒªã¨æ–°ã—ã„å®Ÿè£…ãŒåãã‚¢ã‚»ãƒ³ãƒ–ãƒªã®å·®åˆ†ã‚’å–ã£ã¦ã¿ãŸ


[03/31/2023 5:24 PM] mikiken#5554


{Attachments}
https://cdn.discordapp.com/attachments/1003859454191751178/1091276871473311754/message.txt


[03/31/2023 5:29 PM] mikiken#5554
å°‘ãªãã¨ã‚‚ã€è¡¨é¢çš„ã«å‡ºåŠ›ã•ã‚Œã‚‹ã‚¢ã‚»ãƒ³ãƒ–ãƒªã‚’æ¯”è¼ƒã™ã‚‹ã¨ã€å¤ã„æ–¹ã§ã¯ãã¡ã‚“ã¨`rdi`ã®ä¸‹ä½1byteã‚’èª­ã‚“ã§ã„ã‚‹ä¸€æ–¹ã€æ–°ã—ã„æ–¹ã§ã¯`rdi`ã®ä¸‹ä½4byteã‚’èª­ã‚“ã§ã—ã¾ã£ã¦ã„ã‚‹ã“ã¨ãŒåˆ†ã‹ã‚‹


[03/31/2023 6:18 PM] mikiken#5554
ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ãŒãƒ‡ã‚«ã„ã®ã§ã€ãƒã‚°ãŒå†ç¾ã™ã‚‹ã‚‚ã†å°‘ã—å°ã•ã„ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã‚’è€ƒãˆã‚‹
```C
int printf();

char char_type_test1() {
  char x = -1;
  int y = 4;
  return x + y;
}

int main() {
  printf("%d\n", char_type_test1());
  return 0;
}
```


[03/31/2023 6:22 PM] mikiken#5554


{Attachments}
https://cdn.discordapp.com/attachments/1003859454191751178/1091291456934776902/message.txt


[03/31/2023 7:02 PM] mikiken#5554
ã¨ã‚Šã‚ãˆãšã€ç®—è¡“å‹ã®åŠ æ¸›ç®—ã®nodeè‡ªä½“ã®å‹ã‚’å…¨ã¦`int`ã«ã™ã‚‹ã“ã¨ã§ã€ã²ã¨ã¾ãšå‹•ãã‚ˆã†ã«ãªã£ãŸ


[03/31/2023 7:13 PM] mikiken#5554
`origin/master`ã¨`master`ã®ä¹–é›¢ãŒã™ã”ã„ã“ã¨ã«


[03/31/2023 7:13 PM] mikiken#5554


{Attachments}
https://cdn.discordapp.com/attachments/1003859454191751178/1091304333020237895/image.png


[03/31/2023 7:13 PM] mikiken#5554
ã•ã™ãŒã«ã‚³ãƒŸãƒƒãƒˆãƒ­ã‚°ãŒæ±šã„ã®ã§ã€ãã‚Œã„ã«ã—ãŸã„


[03/31/2023 11:51 PM] mikiken#5554
`git rebase -i`ã—ã¦ãŸã‚‰conflictèµ·ããŸ


[03/31/2023 11:52 PM] mikiken#5554
```
mikiken@DESKTOP-CM4259U:~/compiler/9cc$ git rebase -i HEAD~25
Auto-merging src/semantic_analysis.c
CONFLICT (content): Merge conflict in src/semantic_analysis.c
error: could not apply 59f3168... `ND_ADD`,`ND_SUB`ã§nodeãã®ã‚‚ã®ã®å‹ã‚’ã¡ã‚ƒã‚“ã¨ã—ãŸ
Resolve all conflicts manually, mark them as resolved with
"git add/rm <conflicted_files>", then run "git rebase --continue".
You can instead skip this commit: run "git rebase --skip".
To abort and get back to the state before "git rebase", run "git rebase --abort".
Could not apply 59f3168... `ND_ADD`,`ND_SUB`ã§nodeãã®ã‚‚ã®ã®å‹ã‚’ã¡ã‚ƒã‚“ã¨ã—ãŸ
```


[04/01/2023 1:36 AM] mikiken#5554
ã‚„ã£ãŸãƒ¼ãã‚Œã„ã«ãªã£ãŸããƒ¼

{Attachments}
https://cdn.discordapp.com/attachments/1003859454191751178/1091400539255869490/image.png


[04/02/2023 5:49 PM] mikiken#5554
ã¨ã„ã†ã‚ã‘ã§ã‚ˆã†ã‚„ãå¤šæ¬¡å…ƒé…åˆ—ã®å®Ÿè£…ã«ç€æ‰‹ã—ã¦ã„ã


[04/02/2023 5:51 PM] mikiken#5554
`int arr[3][5];`ã¿ãŸã„ãªå®£è¨€ã«å¯¾ã—ã¦ã€`arr[2][4] = 3;`ã¨æ›¸ã„ãŸã‚‰ã€`*(*(arr + 2) + 4) = 3;`ã¨ãƒ‘ãƒ¼ã‚¹ã™ã‚‹ã‚ˆã†ã«ã¯æ—¢ã«ãªã£ã¦ã‚‹ã¯ãš


[04/02/2023 5:52 PM] mikiken#5554
ã¨ã‚Šã‚ãˆãšã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚’è©¦ã¿ã‚‹ã¨ã€`semantic_analysis() : ä¸æ­£ãªåŠ ç®—ã‚’è¡Œã†ã“ã¨ã¯ã§ãã¾ã›ã‚“`ã¨ã„ã†ã‚¨ãƒ©ãƒ¼ãŒå‡ºã‚‹ã®ã§ã€`semantic_analysis()`ã®`ND_ADD`ã§ä¸¡è¾ºã®å‹ã®ä¸ä¸€è‡´ãŒèµ·ã“ã£ã¦ã„ãã†


[04/02/2023 10:00 PM] mikiken#5554


{Attachments}
https://cdn.discordapp.com/attachments/1003859454191751178/1092071054555480156/image.png


[04/03/2023 3:27 PM] mikiken#5554
ã¾ãšè©¦ã—ã¦ã„ã‚‹ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã¯ã“ã‚Œ
```C
int main() {
  int arr[3][5];
  *(*(arr + 2) + 4) = 3;
  return *(*(arr + 2) + 4);
}
```


[04/03/2023 3:27 PM] mikiken#5554
ä½•ã‚‚è€ƒãˆãšã«ã€`./9cc a.c`ã—ãŸã¨ã“ã‚ã€`semantic_analysis() : ä¸æ­£ãªåŠ ç®—ã‚’è¡Œã†ã“ã¨ã¯ã§ãã¾ã›ã‚“`ãŒå‡ºãŸ


[04/03/2023 3:28 PM] mikiken#5554
ãã‚Œã¯ãã†
(`semantic_analysis()`ã«ãŠã„ã¦ã€å·¦è¾ºã«é…åˆ—å‹ã€å³è¾ºãŒ`int`å‹ã®å ´åˆã®å‡¦ç†ãŒå…¥ã£ã¦ã„ãªã„ã®ã§)


[04/03/2023 3:30 PM] mikiken#5554
ã¨ã„ã†ã“ã¨ã§ã€`ND_ADD`ã®å‡¦ç†ã§ã€å·¦è¾ºã«é…åˆ—å‹ã€å³è¾ºã«`int`å‹ãŒæ¥ãŸå ´åˆã€ã‚µã‚¤ã‚ºèª¿æ•´ç”¨ã®nodeã‚’ä»˜åŠ ã™ã‚‹ã‚ˆã†ãªã‚³ãƒ¼ãƒ‰ã‚’è¿½åŠ ã—ãŸ
```C
      // å·¦è¾ºãŒé…åˆ—å‹ã€å³è¾ºãŒintå‹ã®å ´åˆ
      if (is_array_type(node->lhs->type) && node->rhs->type->kind == TYPE_INT) {
        // nodeè‡ªä½“ã®å‹ã¯å·¦è¾ºã®å‹ã«åˆã‚ã›ã‚‹
        node->type = node->lhs->type;
        Node *size_node = new_size_node(node->lhs->type->ptr_to);
        node->rhs = new_typed_binary(new_typed_node(new_type(TYPE_INT), new_node(ND_MUL)), size_node, node->rhs);
        return;
      }
```


[04/03/2023 3:30 PM] mikiken#5554
å†ã³`./9cc a.c`ã™ã‚‹ã¨ã€`semantic_analysis() : ãƒã‚¤ãƒ³ã‚¿ã§ãªã„ã‚‚ã®ã‚’é–“æ¥å‚ç…§ã™ã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“`ãŒå‡ºãŸ


[04/03/2023 3:32 PM] mikiken#5554
ä»Šã¾ã§ã¯1æ¬¡å…ƒé…åˆ—ã—ã‹ãªã‹ã£ãŸã®ã§ã€`ND_DEREF`ã®`lhs`ã«ã¯å¿…ãš(é…åˆ—å‹ãŒã‚­ãƒ£ã‚¹ãƒˆã•ã‚ŒãŸã“ã¨ã§ç”Ÿã˜ãŸ)ãƒã‚¤ãƒ³ã‚¿å‹ãŒæ¥ã¦ã„ãŸãŒã€ãã®å‰æãŒå´©ã‚ŒãŸ


[04/03/2023 3:32 PM] mikiken#5554
ã¨ã„ã†ã“ã¨ã§ã€ã²ã¨ã¾ãšã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã—ã¨ã„ãŸ


[04/03/2023 3:33 PM] mikiken#5554
å†ã³ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚’è©¦ã¿ã‚‹ã¨ã€ä¸€éƒ¨ã‚¢ã‚»ãƒ³ãƒ–ãƒªãŒå‡ºåŠ›ã•ã‚Œã‚‹ã‚‚ã®ã®ã€é€”ä¸­ã§`codegen.c`ã«ãŠã„ã¦`ãƒ¬ã‚¸ã‚¹ã‚¿ã«å€¤ã‚’ã‚»ãƒƒãƒˆã§ãã¾ã›ã‚“ã§ã—ãŸ`ãŒå‡ºã¦ã‚‹ãª


[04/03/2023 7:48 PM] mikiken#5554
ã¨ã‚Šã‚ãˆãšgdbã‚’èµ°ã‚‰ã›ã¦ç¢ºèªã—ãŸã¨ã“ã‚ã€å†…å´ã®`ND_DEREF`ã§ãƒ¬ã‚¸ã‚¹ã‚¿ã«å…¥ã£ã¦ã„ã‚‹ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å‚ç…§ã—ã‚ˆã†ã¨ã—ãŸã¨ã“ã‚ã€`mov_memory_to_register`ã«é…åˆ—å‹ã®æ‰±ã„ãŒãªã„ãŸã‚ã€ã‚¨ãƒ©ãƒ¼ãŒå‡ºã¦ã„ã‚‹ã£ã½ã„
```C
    case ND_DEREF:
      gen_expr(node->lhs);
      pop_addr(RDI);
      mov_memory_to_register(node->type, RAX, RDI); // ã“ã®é–¢æ•°ã§ã€Œãƒ¬ã‚¸ã‚¹ã‚¿ã«å€¤ã‚’ã‚»ãƒƒãƒˆã§ãã¾ã›ã‚“ã§ã—ãŸã€ãŒå‡ºã¦ã‚‹
      push(node->type, RAX);
      return;
```


[04/03/2023 7:50 PM] mikiken#5554
`ND_DEREF`ã®`lhs`ã®å‹ãŒã€é…åˆ—å‹(=ãƒã‚¤ãƒ³ã‚¿å‹ã§ã¯ãªã„)ã§ã‚ã‚‹å ´åˆã€`gen_expr(node->lhs);`ã§ç”Ÿæˆã•ã‚ŒãŸã‚¢ãƒ‰ãƒ¬ã‚¹ã®ä¸­èº«ã‚’å‚ç…§ã™ã‚‹å‡¦ç†ã‚’é£›ã°ã•ãªã‘ã‚Œã°ã„ã‘ãªã„ã®ã§ã¯?


==============================================================
Exported 290 message(s)
==============================================================
